(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ca7c340"],{"016c":function(e,t,a){"use strict";var n=a("0ce3"),i=a.n(n);i.a},"0ce3":function(e,t,a){},"5bf3":function(e,t,a){"use strict";t["a"]={ADD:{value:"1",text:"新增",color:"green"},CHANGE:{value:"2",text:"变更",color:"green"},UNDO:{value:"3",text:"撤销",color:"red"}}},eb1e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("page-header-wrapper",[n("div",{staticClass:"personnelReport-box"},[n("a-card",{attrs:{bordered:!1}},[n("help"),n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:16}},[n("a-col",{attrs:{xs:24,lg:8,xl:6,xxl:5}},[n("a-form-item",{attrs:{label:"快速搜索"}},[n("a-input",{attrs:{placeholder:"请输入姓名\\公民身份号码"},on:{blur:t.searchClick},model:{value:t.query.selectValue,callback:function(e){t.$set(t.query,"selectValue",e)},expression:"query.selectValue"}})],1)],1),n("a-col",{attrs:{xs:24,lg:8,xl:7,xxl:5}},[n("a-form-item",{attrs:{label:"报备类型"}},[n("a-select",{attrs:{allowClear:"",placeholder:"请选择报备类型","default-value":"0"},on:{change:t.searchClick},model:{value:t.query.type,callback:function(e){t.$set(t.query,"type",e)},expression:"query.type"}},t._l(t.reportTypeList,(function(e,a){return n("a-select-option",{key:a,attrs:{value:e.value}},[t._v(t._s(e.text))])})),1)],1)],1),n("a-col",{attrs:{xs:24,lg:8,xl:6,xxl:5}},[n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{attrs:{allowClear:"",placeholder:"请选择状态","default-value":"0"},on:{change:t.searchClick},model:{value:t.query.state,callback:function(e){t.$set(t.query,"state",e)},expression:"query.state"}},t._l(t.stateList,(function(e,a){return n("a-select-option",{key:a,attrs:{value:e.value}},[t._v(t._s(e.text))])})),1)],1)],1),n("a-col",{attrs:{xs:12,lg:12,xl:5,xxl:3}},[n("a-form-item",{staticClass:"ycl-label"},[n("a-button",{on:{click:t.searchClick}},[t._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){e.query={},e.searchClick()}}},[t._v("重置")])],1)],1)],1)],1)],1),n("div",{staticStyle:{"margin-top":"20px"}},[n("a-table",{attrs:{rowKey:function(e){return e.id},columns:t.tableColumnList,pagination:t.pagination,"data-source":t.tableDataList},on:{change:t.tableChange},scopedSlots:t._u([{key:"name",fn:function(e,a){return n("span",{},["1"==a.otherUnitRemind?n("a-badge",{attrs:{color:"red"}}):t._e(),t._v(" "+t._s(a.surname+a.name)+" ")],1)}},{key:"cardID",fn:function(e,a){return n("span",{},[t._v(t._s(t._f("cardIDShade")(a.cardID)))])}},{key:"professionalPost",fn:function(e,a){return n("span",{},[t._v(t._s(t._f("professionalPostFilter")(a.professionalPost)))])}},{key:"reportType",fn:function(e,a){return n("span",{},[n("a-badge",{attrs:{color:t._f("reportTypeColorFilter")(e),text:t._f("reportTypeFilter")(e)}})],1)}},{key:"state",fn:function(e,a){return n("span",{},[n("a-badge",{attrs:{color:t._f("stateColorFilter")(e),text:t._f("stateFilter")(e)}})],1)}},{key:"operate",fn:function(e,a){return n("span",{staticClass:"ycl-operate"},[n("a",{on:{click:function(e){return t.detailsClick("详情",a)}}},[t._v("详情")])])}}])})],1)],1)],1),n("a-modal",{attrs:{visible:t.detailsDialogVisible,title:"人员报备详情",width:"800px",destroyOnClose:"",centered:!0,footer:null},on:{cancel:function(e){t.detailsDialogVisible=!1},ok:function(e){t.detailsDialogVisible=!1}}},[n("personnel-report-details",{attrs:{type:t.detailsModalData.type,details:t.detailsModalData.details,close:t.closeClick},on:{showerrorModal:t.showerrorModal}})],1),n("a-modal",{attrs:{visible:t.errorDetailsDialogVisible,title:"批量导入错误信息",width:"800px",destroyOnClose:"",maskClosable:!1,centered:!0,footer:null},on:{cancel:function(e){t.errorDetailsDialogVisible=!1},ok:function(e){t.errorDetailsDialogVisible=!1}}},[n("a-table",{attrs:{columns:t.errorTableColumnList,"data-source":t.errorTableDataList}})],1),n("a-modal",{attrs:{visible:t.errorvisible,footer:null,title:"异常告警信息",width:"500px",destroyOnClose:"",centered:!0},on:{cancel:function(e){t.errorvisible=!1}}},[n("h3",{staticStyle:{"text-align":"center",color:"red"}},[t._v("异常原因:人员公民身份号码与姓名不符")]),n("div",{staticStyle:{display:"flex"}},[n("a-icon",{staticStyle:{color:"rgb(232,200,5)","font-size":"70px",margin:"10px auto"},attrs:{type:"warning"}})],1),n("p",{staticStyle:{width:"300px","text-align":"center",margin:"20px auto"}},[t._v("当前申请人信息(姓名：胡定妹,公民身份号码:330206194309158743经核实与实际人员信息不符，请核对人员姓名与公民身份号码是否为同一人员后再次申请")])])],1)},i=[],r=(a("99af"),a("a623"),a("4de4"),a("7db0"),a("4160"),a("caad"),a("a15b"),a("baa5"),a("d81d"),a("fb6a"),a("b0c0"),a("a9e3"),a("d3b7"),a("07ac"),a("ac1f"),a("25f0"),a("2532"),a("5319"),a("159b"),a("96cf"),a("1da1")),s=a("5530"),o=a("ca00"),l=a("1146"),c=a.n(l),u=a("c1df"),d=a.n(u),p=a("946f"),f=a("5bf3"),h=a("166e"),g=a("e56e"),b=a("3705"),m=a("7c5f"),y=a("03b9"),x=a("6250"),v={0:{text:"主任"},1:{text:"干部"}},w={filters:{reportTypeFilter:function(e){return Object.values(f["a"]).find((function(t){return t.value===e})).text},reportTypeColorFilter:function(e){return Object.values(f["a"]).find((function(t){return t.value===e})).color},stateFilter:function(e){return Object.values(p["a"]).find((function(t){return t.value===e})).text},stateColorFilter:function(e){return Object.values(p["a"]).find((function(t){return t.value===e})).color},professionalPostFilter:function(e){return v[e].text},cardIDShade:o["a"]},data:function(){var e=this;return{query:{},reportTypeList:f["a"],stateList:p["a"],tableColumnList:[{title:"姓名",dataIndex:"name",align:"center",width:"200px",scopedSlots:{customRender:"name"}},{title:"公民身份号码",dataIndex:"cardID",width:"200px",align:"center",scopedSlots:{customRender:"cardID"}},{title:"性别",dataIndex:"sex",width:"200px",align:"center"},{title:"出生日期",dataIndex:"birthday",width:"200px",align:"center"},{title:"报备类型",dataIndex:"reportType",width:"200px",align:"center",scopedSlots:{customRender:"reportType"}},{title:"状态",dataIndex:"state",width:"200px",align:"center",scopedSlots:{customRender:"state"}},{title:"报备时间",dataIndex:"registryday",width:"200px",align:"center"},{title:"操作",dataIndex:"operate",scopedSlots:{customRender:"operate"},width:"200px",align:"center"}],tableDataList:[],pagination:{showSizeChanger:!0,showQuickJumper:!0,pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showTotal:function(t,a){return"共 ".concat(t," 条记录 第").concat(e.pagination.current,"/").concat(Math.ceil(t/e.pagination.pageSize),"页")},onChange:function(t,a){e.pagination.current=t},onShowSizeChange:function(t,a){e.pagination.current=t,e.pagination.pageSize=a}},rankList:[],jobList:[],politicalStatusList:[],educationList:[],tableSelectedRows:[],detailsDialogVisible:!1,detailsModalData:{type:"",details:{}},excelData:{},uploading:!1,downloading:!1,errorDetailsDialogVisible:!1,errorTableColumnList:[{title:"公民身份号码",dataIndex:"cardID",align:"center",width:"200px",scopedSlots:{customRender:"cardID"}},{title:"错误信息",dataIndex:"unSuccessInfo",width:"200px",align:"center"}],errorTableDataList:[],excelColumns:[{header:"公民身份号码（必填）",key:"cardID",width:20,style:{numFmt:"@"}},{header:"姓（必填）",key:"surname",width:20,style:{numFmt:null}},{header:"名（必填）",key:"name",width:20},{header:"手机号码（必填）",key:"mobilePhone",width:20},{header:"工作单位（必填）",key:"",width:20,style:{numFmt:"@"}},{header:"职务（必填）",key:"professionalPost",width:20},{header:"政治面貌（必填）",key:"politicalOutlook",width:20},{header:"备注",key:"remarks",width:20,style:{numFmt:"@"}}],errorvisible:!1,errInfo:{}}},computed:{rowSelection:function(){var e=this;return{onChange:function(t,a){e.tableSelectedRows=a},getCheckboxProps:function(e){return{props:{disabled:"Disabled User"===e.name,name:e.name}}}}}},created:function(){this.pagination.total=this.tableDataList.length,this.getDictionaryProfessionalJob(),this.getDictionaryProfessionalTitle(),this.getDictionaryPoliticalOutlook(),this.getDictionaryEducation()},mounted:function(){},watch:{},methods:{showerrorModal:function(e){this.errInfo=e,this.errorvisible=!0},tableChange:function(e,t,a){var n=Object(s["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.getPersonReport()},getPersonReport:function(){var e=this,t=Object(s["a"])({pageNo:this.pagination.current,pageSize:this.pagination.pageSize,direction:"1"},this.query);Object(h["h"])(t).then((function(t){var a=t.data;e.pagination.total=Number(a.total),e.tableDataList=a.list&&a.list.length?a.list:[]}))},getDictionaryProfessionalJob:function(){var e=this;Object(g["c"])().then((function(t){var a=t.data;if(v={},a.list&&a.list.length){e.jobList=a.list;for(var n=0;n<a.list.length;n++){var i=a.list[n];v[i.value]={text:i.label}}}e.getPersonReport()}))},getDictionaryProfessionalTitle:function(){var e=this;Object(g["d"])().then((function(t){var a=t.data;e.rankList=a.list&&a.list.length?a.list:[]}))},getDictionaryPoliticalOutlook:function(){var e=this;Object(g["b"])().then((function(t){var a=t.data;e.politicalStatusList=a.list&&a.list.length?a.list:[]}))},getDictionaryEducation:function(){var e=this;Object(g["a"])().then((function(t){var a=t.data;e.educationList=a.list&&a.list.length?a.list:[]}))},deleteReport:function(e){var t=this;Object(h["d"])(e).then((function(e){t.$message.success("删除备案成功")}))},searchClick:function(){this.pagination.current=1,this.getPersonReport()},batchDeletionClick:function(){this.deletePersonnel()},detailsClick:function(e,t){var a=t||{};if("详情"==e&&"1"==t.otherUnitRemind){var n=[t.id];this.deleteRemindRegistriesOtherunitList(n)}this.detailsDialogVisible=!0,this.detailsModalData.type=e,this.detailsModalData.details=a},getRemindRegistriesOtherunitList:function(){var e=this;Object(y["d"])({pageNo:"1",pageSize:"5",direction:"1"}).then((function(t){e.$store.state.app.warningPersonCount=Number(t.data.total)}))},deleteRemindRegistriesOtherunitList:function(e){var t=this;Object(y["b"])({id:[e]}).then((function(e){})).finally((function(){t.getRemindRegistriesOtherunitList()}))},closeClick:function(){this.detailsDialogVisible=!1,this.detailsModalData={},this.searchClick()},deleteClick:function(e){var t={id:[e.id]};this.deleteReport(t)},batchImportClick:function(){this.$refs["excel-upload-input"].click()},handleSuccess:function(){var e=this,t=this.excelData.results;t.forEach((function(e){e.sex=Number(e.cardID.slice(16,17))%2==0?"女":"男",e.residence=m["a"][e.cardID.slice(0,6)],e.birthday=d()(e.cardID.slice(6,10)+"/"+e.cardID.slice(10,12)+"/"+e.cardID.slice(12,14)).valueOf().toString(),e.birthdayDate=e.birthday})),Object(h["l"])({list:t}).then((function(t){var a=t.data,n=[];e.successCount=a.successCount,e.unSuccessCount=a.unSuccessCount;var i=a.unSuccessList?a.unSuccessList:[];i.forEach((function(e){n.push(e)})),a.successCount>"0"&&e.searchClick(),"0"==a.unSuccessCount?e.$message.success("导入成功"):(e.errorTableDataList=n,e.errorDetailsDialogVisible=!0)})).finally((function(){e.uploading=!1}))},generateData:function(e){var t=e.header,a=e.results;this.excelData.header=t,this.excelData.results=a,this.handleSuccess()},handleClick:function(){var e=this.$refs["excel-upload-input"].files[0];e.name.includes(".xlsx")||e.name.includes(".xls")?this.upload(e):this.$message.warning("请选择xlsx或xls文件")},beforeUpload:function(e){return!1},upload:function(e){this.readerData(e)},readerData:function(e){var t=this;this.uploading=!0;var a=new FileReader;a.onload=function(e){var a=e.target.result,n=c.a.read(a,{type:"array",dateNF:"yyyy-mm-dd"}),i=n.SheetNames[0],r=n.Sheets[i],s=t.getHeaderRow(r),o=t.getJsonData(r),l=o.filter((function(e){return!1===e.satify}));t.$refs["excel-upload-input"].value="",l.length>0?(t.errorTableDataList=l,t.errorDetailsDialogVisible=!0,t.uploading=!1):o.length>0?t.generateData({header:s,results:o}):(t.$message.warning("请选择有数据的excel"),t.uploading=!1)},a.readAsArrayBuffer(e)},getHeaderRow:function(e){var t,a=[],n=c.a.utils.decode_range(e["!ref"]),i=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var r=e[c.a.utils.encode_cell({c:t,r:i})],s="UNKNOWN "+t;r&&r.t&&(s=c.a.utils.format_cell(r)),a.push(s)}return this.excelData.header=a,a},getJsonData:function(e){for(var t=this,a=[],n=["cardID","surname","name","mobilePhone","workUnit","professionalPost","politicalOutlook","remarks"],i=[0,1,2,3,4,5,6],r=c.a.utils.decode_range(e["!ref"]),o={},l=function(l){var u={satify:!0,unSuccessInfo:""};u.personnelManager=t.$store.state.app.unitInfo.unitName;for(var d=function(a){var i=e[c.a.utils.encode_cell({c:a,r:l})];switch(u[n[a]]=c.a.utils.format_cell(i),n[a]){case"cardID":u[n[a]]=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|31)|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}([0-9]|x|X)$/.test(u[n[a]])?u[n[a]]:"",u[n[a]]&&o[u[n[a]]]&&(u.unSuccessInfo="重复的公民身份号码"),o[u[n[a]]]=!0;break;case"surname":case"name":case"workUnit":u[n[a]]=/^[\u4e00-\u9fa5]+$/.test(u[n[a]])?u[n[a]]:"";break;case"mobilePhone":u[n[a]]=/^[1][3-9][0-9]{9}$/.test(u[n[a]])?u[n[a]]:"";break;case"professionalPost":var r=t.jobList.find((function(e){return u[n[a]]===e.label}));u[n[a]]=r?r.value:"";break;case"politicalOutlook":var s=t.politicalStatusList.find((function(e){return u[n[a]]===e.label}));u[n[a]]=s?s.value:"","12"!=u[n[a]]&&"13"!=u[n[a]]||(u["joinPartyDay"]="");break;default:break}},p=r.s.c;p<=r.e.c;++p)d(p);u.unSuccessInfo&&(u.unSuccessInfo+="，第".concat(l,"行以下列出现错误："),u.satify=!1);for(var f=0;f<i.length;f++){var h=i[f];if(!u[n[h]]){u.satify=!1,u.unSuccessInfo||(u.unSuccessInfo="第".concat(l,"行以下列出现错误："));try{if(t.excelData.header[h]!==t.excelColumns[h].header)throw!1;u.unSuccessInfo+="".concat(t.excelColumns[h].header.replace("（必填）",""),"，")}catch(b){u.unSuccessInfo="请使用正确的模板";break}}}u.unSuccessInfo.lastIndexOf("：")===u.unSuccessInfo.length-1&&(u.unSuccessInfo=u.unSuccessInfo.replace("第".concat(l,"行以下列出现错误："),"")),u.unSuccessInfo.lastIndexOf("，")===u.unSuccessInfo.length-1&&(u.unSuccessInfo=u.unSuccessInfo.slice(0,u.unSuccessInfo.length-1));var g=Object(s["a"])({},u);delete g.unSuccessInfo,delete g.personnelManager,!g.satify&&Object.values(g).every((function(e){return 0==e}))||a.push(u)},u=r.s.r+1;u<=r.e.r;++u)l(u);return a},downloadImportTemplateClick:function(){var e=this;this.downloading=!0,a.e("chunk-4bede50a").then(a.bind(null,"176a")).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){var n,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n="人员报备导入模板",i=[{data:[18],operator:"equal",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入18位公民身份号码"},{row:2,data:[8],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:3,data:[10],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:4,data:[13e9,19999999999],type:"whole",operator:"between",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入11位手机号"},{row:12,data:[128],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:14,data:['"'.concat(e.jobList.map((function(e){return e.label})).join(),'"')],type:"list"},{row:15,data:['"'.concat(e.politicalStatusList.map((function(e){return e.label})).join(),'"')],type:"list"},{row:22,data:[256],operator:"lessThanOrEqual",type:"textLength"}],r=0;r<i.length;r++)s=i[r],s.row=r+1;return t.next=5,a.export2Excel({columns:e.excelColumns,list:i,filename:n});case 5:e.downloading=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){e.downloading=!1}))}},components:{personnelReportDetails:b["a"],help:x["a"]}},D=w,k=(a("016c"),a("2877")),S=Object(k["a"])(D,n,i,!1,null,"1875f4a0",null);t["default"]=S.exports}}]);