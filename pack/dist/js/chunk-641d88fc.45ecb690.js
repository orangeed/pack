(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-641d88fc"],{"016c":function(t,e,n){"use strict";var r=n("0ce3"),i=n.n(r);i.a},"0ce3":function(t,e,n){},"1da1":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("d3b7"),n("e6cf");function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}},"28a0":function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},3022:function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!S(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,a=r.length,o=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=a)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}})),c=r[n];n<a;c=r[++n])v(c)||!E(c)?o+=" "+c:o+=" "+s(c);return o},e.deprecate=function(n,r){if("undefined"!==typeof t&&!0===t.noDeprecation)return n;if("undefined"===typeof t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;function a(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}return a};var a,o={};function s(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e._extend(r,n),O(r.showHidden)&&(r.showHidden=!1),O(r.depth)&&(r.depth=2),O(r.colors)&&(r.colors=!1),O(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),f(r,t,r.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function l(t,e){return t}function u(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}function f(t,n,r){if(t.customInspect&&n&&C(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return S(i)||(i=f(t,i,r)),i}var a=p(t,n);if(a)return a;var o=Object.keys(n),s=u(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(n)),I(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return d(n);if(0===o.length){if(C(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(k(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(j(n))return t.stylize(Date.prototype.toString.call(n),"date");if(I(n))return d(n)}var l,m="",v=!1,x=["{","}"];if(b(n)&&(v=!0,x=["[","]"]),C(n)){var w=n.name?": "+n.name:"";m=" [Function"+w+"]"}return k(n)&&(m=" "+RegExp.prototype.toString.call(n)),j(n)&&(m=" "+Date.prototype.toUTCString.call(n)),I(n)&&(m=" "+d(n)),0!==o.length||v&&0!=n.length?r<0?k(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=v?h(t,n,r,s,o):o.map((function(e){return g(t,n,r,s,e,v)})),t.seen.pop(),y(l,m,x)):x[0]+m+x[1]}function p(t,e){if(O(e))return t.stylize("undefined","undefined");if(S(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return w(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var a=[],o=0,s=e.length;o<s;++o)L(e,String(o))?a.push(g(t,e,n,r,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(g(t,e,n,r,i,!0))})),a}function g(t,e,n,r,i,a){var o,s,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),L(r,i)||(o="["+i+"]"),s||(t.seen.indexOf(c.value)<0?(s=v(n)?f(t,c.value,null):f(t,c.value,n-1),s.indexOf("\n")>-1&&(s=a?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n"))):s=t.stylize("[Circular]","special")),O(o)){if(a&&i.match(/^\d+$/))return s;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+s}function y(t,e,n){var r=t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function b(t){return Array.isArray(t)}function m(t){return"boolean"===typeof t}function v(t){return null===t}function x(t){return null==t}function w(t){return"number"===typeof t}function S(t){return"string"===typeof t}function D(t){return"symbol"===typeof t}function O(t){return void 0===t}function k(t){return E(t)&&"[object RegExp]"===_(t)}function E(t){return"object"===typeof t&&null!==t}function j(t){return E(t)&&"[object Date]"===_(t)}function I(t){return E(t)&&("[object Error]"===_(t)||t instanceof Error)}function C(t){return"function"===typeof t}function P(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t}function _(t){return Object.prototype.toString.call(t)}function R(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(O(a)&&(a=Object({NODE_ENV:"production",VUE_APP_API_BASE_URL:"http://127.0.0.1:13010/zjg/2d",VUE_APP_PREVIEW:"false",BASE_URL:""}).NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(a)){var r=t.pid;o[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else o[n]=function(){};return o[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=b,e.isBoolean=m,e.isNull=v,e.isNullOrUndefined=x,e.isNumber=w,e.isString=S,e.isSymbol=D,e.isUndefined=O,e.isRegExp=k,e.isObject=E,e.isDate=j,e.isError=I,e.isFunction=C,e.isPrimitive=P,e.isBuffer=n("d60a");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function q(){var t=new Date,e=[R(t.getHours()),R(t.getMinutes()),R(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",q(),e.format.apply(e,arguments))},e.inherits=n("28a0"),e._extend=function(t,e){if(!e||!E(e))return t;var n=Object.keys(e),r=n.length;while(r--)t[n[r]]=e[n[r]];return t};var z="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function F(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}function A(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!==typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};e.apply(this,n).then((function(e){t.nextTick(o,null,e)}),(function(e){t.nextTick(F,e,o)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}e.promisify=function(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');if(z&&t[z]){var e=t[z];if("function"!==typeof e)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,z,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(o){n(o)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),z&&Object.defineProperty(e,z,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=z,e.callbackify=A}).call(this,n("4362"))},"5bf3":function(t,e,n){"use strict";e["a"]={ADD:{value:"1",text:"新增",color:"green"},CHANGE:{value:"2",text:"变更",color:"green"},UNDO:{value:"3",text:"撤销",color:"red"}}},d60a:function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},eb1e:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=this,n=e.$createElement,r=e._self._c||n;return r("page-header-wrapper",[r("div",{staticClass:"personnelReport-box"},[r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"}},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{xs:24,lg:8,xl:6,xxl:5}},[r("a-form-item",{attrs:{label:"快速搜索"}},[r("a-input",{attrs:{placeholder:"请输入姓名\\公民身份号码"},on:{blur:e.searchClick},model:{value:e.query.selectValue,callback:function(t){e.$set(e.query,"selectValue",t)},expression:"query.selectValue"}})],1)],1),r("a-col",{attrs:{xs:24,lg:8,xl:7,xxl:5}},[r("a-form-item",{attrs:{label:"报备类型"}},[r("a-select",{attrs:{allowClear:"",placeholder:"请选择报备类型","default-value":"0"},on:{change:e.searchClick},model:{value:e.query.type,callback:function(t){e.$set(e.query,"type",t)},expression:"query.type"}},e._l(e.reportTypeList,(function(t,n){return r("a-select-option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.text))])})),1)],1)],1),r("a-col",{attrs:{xs:24,lg:8,xl:6,xxl:5}},[r("a-form-item",{attrs:{label:"状态"}},[r("a-select",{attrs:{allowClear:"",placeholder:"请选择状态","default-value":"0"},on:{change:e.searchClick},model:{value:e.query.state,callback:function(t){e.$set(e.query,"state",t)},expression:"query.state"}},e._l(e.stateList,(function(t,n){return r("a-select-option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.text))])})),1)],1)],1),r("a-col",{attrs:{xs:12,lg:12,xl:5,xxl:3}},[r("a-form-item",{staticClass:"ycl-label"},[r("a-button",{on:{click:e.searchClick}},[e._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){t.query={},t.searchClick()}}},[e._v("重置")])],1)],1)],1)],1)],1),r("div",{staticStyle:{"margin-top":"20px"}},[r("a-table",{attrs:{rowKey:function(t){return t.id},columns:e.tableColumnList,pagination:e.pagination,"data-source":e.tableDataList},on:{change:e.tableChange},scopedSlots:e._u([{key:"name",fn:function(t,n){return r("span",{},["1"==n.otherUnitRemind?r("a-badge",{attrs:{color:"red"}}):e._e(),e._v(" "+e._s(n.surname+n.name)+" ")],1)}},{key:"cardID",fn:function(t,n){return r("span",{},[e._v(e._s(e._f("cardIDShade")(n.cardID)))])}},{key:"professionalPost",fn:function(t,n){return r("span",{},[e._v(e._s(e._f("professionalPostFilter")(n.professionalPost)))])}},{key:"reportType",fn:function(t,n){return r("span",{},[r("a-badge",{attrs:{color:e._f("reportTypeColorFilter")(t),text:e._f("reportTypeFilter")(t)}})],1)}},{key:"state",fn:function(t,n){return r("span",{},[r("a-badge",{attrs:{color:e._f("stateColorFilter")(t),text:e._f("stateFilter")(t)}})],1)}},{key:"operate",fn:function(t,n){return r("span",{staticClass:"ycl-operate"},[r("a",{on:{click:function(t){return e.detailsClick("详情",n)}}},[e._v("详情")])])}}])})],1)])],1),r("a-modal",{attrs:{visible:e.detailsDialogVisible,title:"人员报备详情",width:"800px",destroyOnClose:"",centered:!0,footer:null},on:{cancel:function(t){e.detailsDialogVisible=!1},ok:function(t){e.detailsDialogVisible=!1}}},[r("personnel-report-details",{attrs:{type:e.detailsModalData.type,details:e.detailsModalData.details,close:e.closeClick},on:{showerrorModal:e.showerrorModal}})],1),r("a-modal",{attrs:{visible:e.errorDetailsDialogVisible,title:"批量导入错误信息",width:"800px",destroyOnClose:"",maskClosable:!1,centered:!0,footer:null},on:{cancel:function(t){e.errorDetailsDialogVisible=!1},ok:function(t){e.errorDetailsDialogVisible=!1}}},[r("a-table",{attrs:{columns:e.errorTableColumnList,"data-source":e.errorTableDataList}})],1),r("a-modal",{attrs:{visible:e.errorvisible,footer:null,title:"异常告警信息",width:"500px",destroyOnClose:"",centered:!0},on:{cancel:function(t){e.errorvisible=!1}}},[r("h3",{staticStyle:{"text-align":"center",color:"red"}},[e._v("异常原因:人员公民身份号码与姓名不符")]),r("div",{staticStyle:{display:"flex"}},[r("a-icon",{staticStyle:{color:"rgb(232,200,5)","font-size":"70px",margin:"10px auto"},attrs:{type:"warning"}})],1),r("p",{staticStyle:{width:"300px","text-align":"center",margin:"20px auto"}},[e._v(" 当前申请人信息(姓名：胡定妹,公民身份号码:330206194309158743经核实与实际人员信息不符，请核对人员姓名与公民身份号码是否为同一人员后再次申请 ")])])],1)},i=[],a=(n("99af"),n("a623"),n("4de4"),n("7db0"),n("4160"),n("caad"),n("a15b"),n("baa5"),n("d81d"),n("fb6a"),n("b0c0"),n("a9e3"),n("d3b7"),n("07ac"),n("ac1f"),n("25f0"),n("2532"),n("5319"),n("159b"),n("96cf"),n("1da1")),o=n("5530"),s=n("ca00"),c=n("1146"),l=n.n(c),u=n("c1df"),f=n.n(u),p=n("946f"),d=n("5bf3"),h=n("166e"),g=n("e56e"),y=n("3705"),b=(n("f654"),n("7c5f")),m=n("03b9"),v={0:{text:"主任"},1:{text:"干部"}},x={filters:{reportTypeFilter:function(t){return Object.values(d["a"]).find((function(e){return e.value===t})).text},reportTypeColorFilter:function(t){return Object.values(d["a"]).find((function(e){return e.value===t})).color},stateFilter:function(t){return Object.values(p["a"]).find((function(e){return e.value===t})).text},stateColorFilter:function(t){return Object.values(p["a"]).find((function(e){return e.value===t})).color},professionalPostFilter:function(t){return v[t].text},cardIDShade:s["a"]},data:function(){var t=this;return{query:{},reportTypeList:d["a"],stateList:p["a"],tableColumnList:[{title:"姓名",dataIndex:"name",align:"center",width:"200px",scopedSlots:{customRender:"name"}},{title:"公民身份号码",dataIndex:"cardID",width:"200px",align:"center",scopedSlots:{customRender:"cardID"}},{title:"性别",dataIndex:"sex",width:"200px",align:"center"},{title:"出生日期",dataIndex:"birthday",width:"200px",align:"center"},{title:"报备类型",dataIndex:"reportType",width:"200px",align:"center",scopedSlots:{customRender:"reportType"}},{title:"状态",dataIndex:"state",width:"200px",align:"center",scopedSlots:{customRender:"state"}},{title:"报备时间",dataIndex:"registryday",width:"200px",align:"center"},{title:"操作",dataIndex:"operate",scopedSlots:{customRender:"operate"},width:"200px",align:"center"}],tableDataList:[],pagination:{showSizeChanger:!0,showQuickJumper:!0,pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showTotal:function(e,n){return"共 ".concat(e," 条记录 第").concat(t.pagination.current,"/").concat(Math.ceil(e/t.pagination.pageSize),"页")},onChange:function(e,n){t.pagination.current=e},onShowSizeChange:function(e,n){t.pagination.current=e,t.pagination.pageSize=n}},rankList:[],jobList:[],politicalStatusList:[],educationList:[],tableSelectedRows:[],detailsDialogVisible:!1,detailsModalData:{type:"",details:{}},excelData:{},uploading:!1,downloading:!1,errorDetailsDialogVisible:!1,errorTableColumnList:[{title:"公民身份号码",dataIndex:"cardID",align:"center",width:"200px",scopedSlots:{customRender:"cardID"}},{title:"错误信息",dataIndex:"unSuccessInfo",width:"200px",align:"center"}],errorTableDataList:[],excelColumns:[{header:"公民身份号码（必填）",key:"cardID",width:20,style:{numFmt:"@"}},{header:"姓（必填）",key:"surname",width:20,style:{numFmt:null}},{header:"名（必填）",key:"name",width:20},{header:"手机号码（必填）",key:"mobilePhone",width:20},{header:"工作单位（必填）",key:"",width:20,style:{numFmt:"@"}},{header:"职务（必填）",key:"professionalPost",width:20},{header:"政治面貌（必填）",key:"politicalOutlook",width:20},{header:"备注",key:"remarks",width:20,style:{numFmt:"@"}}],errorvisible:!1,errInfo:{}}},computed:{rowSelection:function(){var t=this;return{onChange:function(e,n){t.tableSelectedRows=n},getCheckboxProps:function(t){return{props:{disabled:"Disabled User"===t.name,name:t.name}}}}}},created:function(){this.pagination.total=this.tableDataList.length,this.getDictionaryProfessionalJob(),this.getDictionaryProfessionalTitle(),this.getDictionaryPoliticalOutlook(),this.getDictionaryEducation()},mounted:function(){},watch:{},methods:{showerrorModal:function(t){this.errInfo=t,this.errorvisible=!0},tableChange:function(t,e,n){var r=Object(o["a"])({},this.pagination);r.current=t.current,this.pagination=r,this.getPersonReport()},getPersonReport:function(){var t=this,e=Object(o["a"])({pageNo:this.pagination.current,pageSize:this.pagination.pageSize,direction:"1"},this.query);Object(h["h"])(e).then((function(e){var n=e.data;t.pagination.total=Number(n.total),t.tableDataList=n.list&&n.list.length?n.list:[]}))},getDictionaryProfessionalJob:function(){var t=this;Object(g["c"])().then((function(e){var n=e.data;if(v={},n.list&&n.list.length){t.jobList=n.list;for(var r=0;r<n.list.length;r++){var i=n.list[r];v[i.value]={text:i.label}}}t.getPersonReport()}))},getDictionaryProfessionalTitle:function(){var t=this;Object(g["d"])().then((function(e){var n=e.data;t.rankList=n.list&&n.list.length?n.list:[]}))},getDictionaryPoliticalOutlook:function(){var t=this;Object(g["b"])().then((function(e){var n=e.data;t.politicalStatusList=n.list&&n.list.length?n.list:[]}))},getDictionaryEducation:function(){var t=this;Object(g["a"])().then((function(e){var n=e.data;t.educationList=n.list&&n.list.length?n.list:[]}))},deleteReport:function(t){var e=this;Object(h["d"])(t).then((function(t){t.data;e.$message.success("删除备案成功")}))},searchClick:function(){this.pagination.current=1,this.getPersonReport()},batchDeletionClick:function(){this.deletePersonnel()},detailsClick:function(t,e){var n=e||{};if("详情"==t&&"1"==e.otherUnitRemind){var r=[e.id];this.deleteRemindRegistriesOtherunitList(r)}this.detailsDialogVisible=!0,this.detailsModalData.type=t,this.detailsModalData.details=n},getRemindRegistriesOtherunitList:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;getRemindRegistriesOtherunitList({pageNo:"1",pageSize:"5",direction:"1"}).then((function(e){t.$store.state.app.warningPersonCount=Number(e.data.total)}))})),deleteRemindRegistriesOtherunitList:function(t){var e=this;Object(m["b"])({id:[t]}).then((function(t){})).finally((function(){e.getRemindRegistriesOtherunitList()}))},closeClick:function(){this.detailsDialogVisible=!1,this.detailsModalData={},this.searchClick()},deleteClick:function(t){var e={id:[t.id]};this.deleteReport(e)},batchImportClick:function(){this.$refs["excel-upload-input"].click()},handleSuccess:function(){var t=this,e=this.excelData,n=e.results;e.header;n.forEach((function(t){t.sex=Number(t.cardID.slice(16,17))%2==0?"女":"男",t.residence=b["a"][t.cardID.slice(0,6)],t.birthday=f()(t.cardID.slice(6,10)+"/"+t.cardID.slice(10,12)+"/"+t.cardID.slice(12,14)).valueOf().toString(),t.birthdayDate=t.birthday})),Object(h["l"])({list:n}).then((function(e){var n=e.data,r=[];t.successCount=n.successCount,t.unSuccessCount=n.unSuccessCount;var i=n.unSuccessList?n.unSuccessList:[];i.forEach((function(t){r.push(t)})),n.successCount>"0"&&t.searchClick(),"0"==n.unSuccessCount?t.$message.success("导入成功"):(t.errorTableDataList=r,t.errorDetailsDialogVisible=!0)})).finally((function(){t.uploading=!1}))},generateData:function(t){var e=t.header,n=t.results;this.excelData.header=e,this.excelData.results=n,this.handleSuccess()},handleClick:function(){var t=this.$refs["excel-upload-input"].files[0];t.name.includes(".xlsx")||t.name.includes(".xls")?this.upload(t):this.$message.warning("请选择xlsx或xls文件")},beforeUpload:function(t){t.name;return!1},upload:function(t){this.readerData(t)},readerData:function(t){var e=this;this.uploading=!0;var n=new FileReader;n.onload=function(t){var n=t.target.result,r=l.a.read(n,{type:"array",dateNF:"yyyy-mm-dd"}),i=r.SheetNames[0],a=r.Sheets[i],o=e.getHeaderRow(a),s=e.getJsonData(a),c=s.filter((function(t){return!1===t.satify}));e.$refs["excel-upload-input"].value="",c.length>0?(e.errorTableDataList=c,e.errorDetailsDialogVisible=!0,e.uploading=!1):s.length>0?e.generateData({header:o,results:s}):(e.$message.warning("请选择有数据的excel"),e.uploading=!1)},n.readAsArrayBuffer(t)},getHeaderRow:function(t){var e,n=[],r=l.a.utils.decode_range(t["!ref"]),i=r.s.r;for(e=r.s.c;e<=r.e.c;++e){var a=t[l.a.utils.encode_cell({c:e,r:i})],o="UNKNOWN "+e;a&&a.t&&(o=l.a.utils.format_cell(a)),n.push(o)}return this.excelData.header=n,n},getJsonData:function(t){for(var e=this,n=[],r=["cardID","surname","name","mobilePhone","workUnit","professionalPost","politicalOutlook","remarks"],i=[0,1,2,3,4,5,6],a=l.a.utils.decode_range(t["!ref"]),s={},c=function(c){var u={satify:!0,unSuccessInfo:""};u.personnelManager=e.$store.state.app.unitInfo.unitName;for(var f=function(n){var i=t[l.a.utils.encode_cell({c:n,r:c})];switch(u[r[n]]=l.a.utils.format_cell(i),r[n]){case"cardID":u[r[n]]=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|31)|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}([0-9]|x|X)$/.test(u[r[n]])?u[r[n]]:"",u[r[n]]&&s[u[r[n]]]&&(u.unSuccessInfo="重复的公民身份号码"),s[u[r[n]]]=!0;break;case"surname":case"name":case"workUnit":u[r[n]]=/^[\u4e00-\u9fa5]+$/.test(u[r[n]])?u[r[n]]:"";break;case"mobilePhone":u[r[n]]=/^[1][3-9][0-9]{9}$/.test(u[r[n]])?u[r[n]]:"";break;case"professionalPost":var a=e.jobList.find((function(t){return u[r[n]]===t.label}));u[r[n]]=a?a.value:"";break;case"politicalOutlook":var o=e.politicalStatusList.find((function(t){return u[r[n]]===t.label}));u[r[n]]=o?o.value:"","12"!=u[r[n]]&&"13"!=u[r[n]]||(u["joinPartyDay"]="");break;default:break}},p=a.s.c;p<=a.e.c;++p)f(p);u.unSuccessInfo&&(u.unSuccessInfo+="，第".concat(c,"行以下列出现错误："),u.satify=!1);for(var d=0;d<i.length;d++){var h=i[d];if(!u[r[h]]){u.satify=!1,u.unSuccessInfo||(u.unSuccessInfo="第".concat(c,"行以下列出现错误："));try{if(e.excelData.header[h]!==e.excelColumns[h].header)throw!1;u.unSuccessInfo+="".concat(e.excelColumns[h].header.replace("（必填）",""),"，")}catch(y){u.unSuccessInfo="请使用正确的模板";break}}}u.unSuccessInfo.lastIndexOf("：")===u.unSuccessInfo.length-1&&(u.unSuccessInfo=u.unSuccessInfo.replace("第".concat(c,"行以下列出现错误："),"")),u.unSuccessInfo.lastIndexOf("，")===u.unSuccessInfo.length-1&&(u.unSuccessInfo=u.unSuccessInfo.slice(0,u.unSuccessInfo.length-1));var g=Object(o["a"])({},u);delete g.unSuccessInfo,delete g.personnelManager,!g.satify&&Object.values(g).every((function(t){return 0==t}))||n.push(u)},u=a.s.r+1;u<=a.e.r;++u)c(u);return n},downloadImportTemplateClick:function(){var t=this;this.downloading=!0,n.e("chunk-06568fb8").then(n.bind(null,"176a")).then(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n){var r,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r="人员报备导入模板",i=[{data:[18],operator:"equal",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入18位公民身份号码"},{row:2,data:[8],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:3,data:[10],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:4,data:[13e9,19999999999],type:"whole",operator:"between",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入11位手机号"},{row:12,data:[128],operator:"lessThanOrEqual",type:"textLength",showInputMessage:!0,promptTitle:"输入提示",prompt:"请输入中文"},{row:14,data:['"'.concat(t.jobList.map((function(t){return t.label})).join(),'"')],type:"list"},{row:15,data:['"'.concat(t.politicalStatusList.map((function(t){return t.label})).join(),'"')],type:"list"},{row:22,data:[256],operator:"lessThanOrEqual",type:"textLength"}],a=0;a<i.length;a++)o=i[a],o.row=a+1;return e.next=5,n.export2Excel({columns:t.excelColumns,list:i,filename:r});case 5:t.downloading=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.downloading=!1}))}},components:{personnelReportDetails:y["a"]}},w=x,S=(n("016c"),n("2877")),D=Object(S["a"])(w,r,i,!1,null,"3c6073a8",null);e["default"]=D.exports},f654:function(t,e,n){"use strict";(function(e){var r=n("320c");
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function a(t){return e.Buffer&&"function"===typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=n("3022"),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l=function(){return"foo"===function(){}.name}();function u(t){return Object.prototype.toString.call(t)}function f(t){return!a(t)&&("function"===typeof e.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var p=t.exports=v,d=/\s*function\s+([^\(\s]*)\s*/;function h(t){if(o.isFunction(t)){if(l)return t.name;var e=t.toString(),n=e.match(d);return n&&n[1]}}function g(t,e){return"string"===typeof t?t.length<e?t:t.slice(0,e):t}function y(t){if(l||!o.isFunction(t))return o.inspect(t);var e=h(t),n=e?": "+e:"";return"[Function"+n+"]"}function b(t){return g(y(t.actual),128)+" "+t.operator+" "+g(y(t.expected),128)}function m(t,e,n,r,i){throw new p.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function v(t,e){t||m(t,!0,e,"==",p.ok)}function x(t,e,n,r){if(t===e)return!0;if(a(t)&&a(e))return 0===i(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"===typeof t||null!==e&&"object"===typeof e){if(f(t)&&f(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(a(t)!==a(e))return!1;r=r||{actual:[],expected:[]};var s=r.actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),S(t,e,n,r))}return n?t===e:t==e}function w(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function S(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=w(t),a=w(e);if(i&&!a||!i&&a)return!1;if(i)return t=c.call(t),e=c.call(e),x(t,e,n);var s,l,u=I(t),f=I(e);if(u.length!==f.length)return!1;for(u.sort(),f.sort(),l=u.length-1;l>=0;l--)if(u[l]!==f[l])return!1;for(l=u.length-1;l>=0;l--)if(s=u[l],!x(t[s],e[s],n,r))return!1;return!0}function D(t,e,n){x(t,e,!0)&&m(t,e,n,"notDeepStrictEqual",D)}function O(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(n){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function k(t){var e;try{t()}catch(n){e=n}return e}function E(t,e,n,r){var i;if("function"!==typeof e)throw new TypeError('"block" argument must be a function');"string"===typeof n&&(r=n,n=null),i=k(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&m(i,n,"Missing expected exception"+r);var a="string"===typeof r,s=!t&&o.isError(i),c=!t&&i&&!n;if((s&&a&&O(i,n)||c)&&m(i,n,"Got unwanted exception"+r),t&&i&&n&&!O(i,n)||!t&&i)throw i}function j(t,e){t||m(t,!0,e,"==",j)}p.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=b(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=h(e),a=r.indexOf("\n"+i);if(a>=0){var o=r.indexOf("\n",a+1);r=r.substring(o+1)}this.stack=r}}},o.inherits(p.AssertionError,Error),p.fail=m,p.ok=v,p.equal=function(t,e,n){t!=e&&m(t,e,n,"==",p.equal)},p.notEqual=function(t,e,n){t==e&&m(t,e,n,"!=",p.notEqual)},p.deepEqual=function(t,e,n){x(t,e,!1)||m(t,e,n,"deepEqual",p.deepEqual)},p.deepStrictEqual=function(t,e,n){x(t,e,!0)||m(t,e,n,"deepStrictEqual",p.deepStrictEqual)},p.notDeepEqual=function(t,e,n){x(t,e,!1)&&m(t,e,n,"notDeepEqual",p.notDeepEqual)},p.notDeepStrictEqual=D,p.strictEqual=function(t,e,n){t!==e&&m(t,e,n,"===",p.strictEqual)},p.notStrictEqual=function(t,e,n){t===e&&m(t,e,n,"!==",p.notStrictEqual)},p.throws=function(t,e,n){E(!0,t,e,n)},p.doesNotThrow=function(t,e,n){E(!1,t,e,n)},p.ifError=function(t){if(t)throw t},p.strict=r(j,p,{equal:p.strictEqual,deepEqual:p.deepStrictEqual,notEqual:p.notStrictEqual,notDeepEqual:p.notDeepStrictEqual}),p.strict.strict=p.strict;var I=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n("c8ba"))}}]);