(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69ca6a54"],{"053d":function(t,e,a){},"16f3":function(t,e,a){"use strict";var i=a("053d"),n=a.n(i);n.a},"176b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return e.alive?i("div",[i("page-header-wrapper",[i("a-card",{staticStyle:{width:"100%"},attrs:{bordered:!1}},[i("help"),i("div",{staticClass:"table-page-search-wrapper",staticStyle:{"margin-bottom":"10px"}},[i("a-form",{attrs:{layout:"inline"}},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{xs:24,lg:8,xl:6,xxl:5}},[i("a-form-item",{attrs:{labelCol:{span:8},wrapperCol:{span:16},label:"快速搜索"}},[i("a-input",{attrs:{placeholder:"请输入：姓名\\公民身份号码"},on:{blur:function(t){return e.searchClick("reset")}},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})],1)],1),i("a-col",{attrs:{xs:12,lg:12,xl:12,xxl:12}},[i("a-button",{on:{click:function(t){return e.searchClick("reset")}}},[e._v("查询")]),i("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.reset("reset")}}},[e._v("重置")]),i("a-button",{staticStyle:{"margin-left":"24px"},attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),i("a-button",{directives:[{name:"show",rawName:"v-show",value:4==e.router.meta.type,expression:"router.meta.type == 4"}],staticStyle:{"margin-left":"8px"},attrs:{loading:e.uploading,disabled:e.uploading},on:{click:e.batchImportClick}},[e._v("数据导入")]),i("input",{ref:"excel-upload-input",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}})],1)],1)],1)],1),i("a-steps",{staticClass:"approvStep",attrs:{type:"navigation"},on:{change:e.changeSteps},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}},e._l(e.stepStateList,(function(t){return i("a-step",{key:t.current,attrs:{title:t.title}})})),1),i("a-table",{attrs:{columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,customRow:e.setRow,rowClassName:function(e){return e.orderNo==t.noworderno?"table-row-check":""}},scopedSlots:e._u([{key:"allname",fn:function(t,a){return i("span",{},[e._v(e._s(a.surname)+e._s(a.name))])}},{key:"cardID",fn:function(t,a){return i("span",{},[e._v(e._s(e._f("cardIDShade")(a.cardID)))])}},{key:"state",fn:function(t){return i("span",{},[i("a-badge",{attrs:{color:e._f("statebageFilter")(t),text:e._f("stateFilter")(t)}})],1)}},{key:"action",fn:function(t,a){return i("span",{staticClass:"action"},[[i("a",{directives:[{name:"show",rawName:"v-show",value:1==e.current,expression:"current == 1"}],on:{click:function(t){return e.printRow(a)}}},[e._v("审核打印")]),i("a",{directives:[{name:"show",rawName:"v-show",value:2==e.current&&"4"==a.state||2==e.current&&"5"==a.state,expression:"(current == 2 && record.state == '4') || (current == 2 && record.state == '5')"}],on:{click:function(t){return e.getElectronicList(a)}}},[e._v("数据提交")]),i("a",{on:{click:function(t){return e.showmodal(a)}}},[e._v("详细")])]],2)}}],null,!1,3547158006)}),i("a-modal",{attrs:{maskClosable:!1,title:e.modalTitle,width:"1200px",footer:null,destroyOnClose:""},on:{cancel:e.cancelApprov},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("a-form-model",{ref:"modalForm",attrs:{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16},rules:e.rules,model:e.modalForm}},[e.visible?i("approvManagementModal",{attrs:{visible:e.visible,modalTitle:e.modalTitle,current:e.current,isadd:e.isadd,educationList:e.educationList,optionDisable:e.optionDisable,isloading:e.isloading,modalForm:e.modalForm,professionalList:e.professionalList,isjoinParty:e.isjoinParty,metaType:e.router.meta.type,metaTypeDetail:e.metaTypeDetail},on:{showpersonModal:e.showpersonModal,putapplicationForm:e.putapplicationForm,nextConsentLetter:e.nextConsentLetter,print:e.print,rePrint:e.rePrint,deleteForm:e.deleteForm,closemodal:e.closemodal,cancel:e.cancel,cancel1:e.cancel1,batchImportClick:e.batchImportClick,handleClick:e.handleClick}}):e._e()],1)],1)],1),i("input",{ref:"excel-upload-input",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),i("a-modal",{attrs:{visible:e.detailsStatusDialogVisible,title:"同意函详细信息",width:"1000px",maskClosable:!1,destroyOnClose:"",centered:!0,footer:null},on:{cancel:e.handleClose}},[i("a-card",{staticClass:"card"},[i("a-form-model",{ref:"ruleForm",attrs:{model:e.detailsForm,rules:e.formRules,"label-col":{span:8},"wrapper-col":{span:16}}},[i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"单据编号",prop:"orderNo"}},[i("a-input",{attrs:{disabled:"",placeholder:"系统自动生成"},model:{value:e.detailsForm.orderNo,callback:function(t){e.$set(e.detailsForm,"orderNo",t)},expression:"detailsForm.orderNo"}})],1),i("a-row",[i("a-col",{attrs:{span:24}},[i("a-form-model-item",{attrs:{"label-col":{span:8},"wrapper-col":{span:16},label:"姓名",prop:"surname"}},[i("a-input",{attrs:{disabled:"",placeholder:"请输入姓名"},model:{value:e.detailsForm.fullName,callback:function(t){e.$set(e.detailsForm,"fullName",t)},expression:"detailsForm.fullName"}})],1)],1)],1),i("a-form-model-item",{attrs:{label:"公民身份号码码",prop:"cardID"}},[i("a-input",{attrs:{disabled:"",placeholder:"请输入公民身份号码码"},model:{value:e.detailsForm.cardID,callback:function(t){e.$set(e.detailsForm,"cardID",t)},expression:"detailsForm.cardID"}})],1),i("a-form-model-item",{attrs:{label:"本人手机号",prop:"myPhone"}},[i("a-input",{attrs:{disabled:"",placeholder:"请输入手机号"},model:{value:e.detailsForm.myPhone,callback:function(t){e.$set(e.detailsForm,"myPhone",t)},expression:"detailsForm.myPhone"}})],1),i("a-form-model-item",{attrs:{label:"性别",prop:"sex"}},[i("a-radio-group",{attrs:{disabled:""},model:{value:e.detailsForm.sex,callback:function(t){e.$set(e.detailsForm,"sex",t)},expression:"detailsForm.sex"}},[i("a-radio",{attrs:{value:"男"}},[e._v("男")]),i("a-radio",{attrs:{value:"女"}},[e._v("女")]),i("a-radio",{attrs:{value:"未知"}},[e._v("未知")])],1)],1),i("a-form-model-item",{attrs:{label:"工作单位",prop:"workUnit"}},[i("a-input",{attrs:{disabled:"",placeholder:"请输入工作单位"},model:{value:e.detailsForm.workUnit,callback:function(t){e.$set(e.detailsForm,"workUnit",t)},expression:"detailsForm.workUnit"}})],1),i("a-form-model-item",{attrs:{label:"单位职务",prop:"professionalPost"}},[i("a-select",{attrs:{allowClear:"",disabled:"","default-value":"0",placeholder:"请选择单位职务"},model:{value:e.detailsForm.professionalPost,callback:function(t){e.$set(e.detailsForm,"professionalPost",t)},expression:"detailsForm.professionalPost"}},e._l(e.jobList,(function(t){return i("a-select-option",{key:t.label,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),i("a-form-model-item",{attrs:{label:"人事部门联系人",prop:"contactPerson"}},[i("a-input",{attrs:{"max-length":30,placeholder:"请输入人事部门联系人",disabled:0==e.current&&!e.isadd},model:{value:e.detailsForm.contactPerson,callback:function(t){e.$set(e.detailsForm,"contactPerson",t)},expression:"detailsForm.contactPerson"}})],1),i("a-form-model-item",{attrs:{label:"联系电话",prop:"contactPhone"}},[i("a-input",{attrs:{"max-length":13,placeholder:"请输入联系电话",disabled:0==e.current&&!e.isadd},model:{value:e.detailsForm.contactPhone,callback:function(t){e.$set(e.detailsForm,"contactPhone",t)},expression:"detailsForm.contactPhone"}})],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"办理证件"}},[i("a-checkbox-group",{staticClass:"ycl-checkbox-group",attrs:{"default-value":e.defaultValue},on:{change:e.certificateCheckboxChange}},[i("div",[i("a-checkbox",{attrs:{disabled:!0,value:"0"}},[e._v("普通护照")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.ordinaryPassportShow,expression:"ordinaryPassportShow"}],staticStyle:{margin:"10px 0px 10px 20px"}},[i("div",{staticStyle:{display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("申请通行证：")]),i("a-select",{staticStyle:{flex:"1.8"},attrs:{"default-value":e._f("passOptions")(e.form.passOption),placeholder:"请选择通行证类型",disabled:e.passDisabled},on:{change:e.handleChangeOrdinaryPassport}},e._l(e.passOptions,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)])],1),i("div",[i("a-checkbox",{attrs:{disabled:!0,value:"1"}},[e._v("往来港澳通行证及签注")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.HKShow,expression:"HKShow"}]},[i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("div",{staticStyle:{display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("申请通行证：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{"default-value":e._f("passOptions")(e.form.hkOption),placeholder:"请选择通行证类型",disabled:e.passDisabled},on:{change:e.handleChangeHK}},e._l(e.passOptions,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)]),e.isShowEndor?i("div",[i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("a-checkbox-group",{attrs:{"default-value":e.HKDefaultValue,disabled:e.optionDisable},on:{change:e.handleChangeEndorsement}},[i("div",{staticStyle:{display:"flex"}},[i("p",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v(" 申请签注： ")]),i("a-checkbox",{staticStyle:{flex:"1.8"},attrs:{value:"0"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.HKDefaultValue.length,expression:"HKDefaultValue.length"}]},[i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("div",{staticStyle:{display:"flex"}},[i("p",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v(" 签注种类： ")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{"default-value":e._f("endorsementOptions")(e.form.hkType),placeholder:"请选择签注种类",disabled:e.optionDisable},on:{change:e.handleChangeHKEndorsement}},e._l(e.endorsementOptions,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)]),i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("div",{staticStyle:{display:"flex",margin:"10px 0px"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("签注类别：")]),i("a-radio-group",{staticStyle:{width:"150px",flex:"1.8"},attrs:{disabled:e.optionDisable},on:{change:e.HMCategoryChange},model:{value:e.form.HMCategory,callback:function(t){e.$set(e.form,"HMCategory",t)},expression:"form.HMCategory"}},[i("a-radio",{attrs:{value:"1"}},[e._v("往来香港签注")]),i("a-radio",{attrs:{value:"2"}},[e._v("往来澳门签注")])],1)],1)]),i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},["1"===e.form.HMCategory?i("div",{staticStyle:{display:"flex",margin:"10px 0px"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("往来香港签注：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{placeholder:"请选择签注时间",disabled:e.optionDisable},on:{change:e.handleChangeHKTime},model:{value:e.form.hkTime,callback:function(t){e.$set(e.form,"hkTime",t)},expression:"form.hkTime"}},e._l(e.endorsementOptions.find((function(t){return t.value===e.KEndorsementIndex})).HKTimeOption,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),"2"===e.form.HMCategory?i("div",{staticStyle:{display:"flex",margin:"10px 0px"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("往来澳门签注：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{placeholder:"请选择签注时间",disabled:e.optionDisable},on:{change:e.handleChangeMacaoTime},model:{value:e.form.macaoTime,callback:function(t){e.$set(e.form,"macaoTime",t)},expression:"form.macaoTime"}},e._l(e.endorsementOptions.find((function(t){return t.value===e.KEndorsementIndex})).MacaoOption,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e()])])]):e._e()])],1),i("div",[i("a-checkbox",{attrs:{disabled:!0,value:"2"}},[e._v("往来台湾通行证及签注")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.TaiwanShow,expression:"TaiwanShow"}]},[i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("div",{staticStyle:{display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("申请通行证：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{"default-value":e._f("passOptions")(e.form.taiwanOption),placeholder:"请选择通行证类型",disabled:e.passDisabled},on:{change:e.handleChangeTaiwan}},e._l(e.passOptions,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)]),e.isShowEndor?i("div",[i("div",{staticStyle:{margin:"10px 0px 10px 20px"}},[i("a-checkbox-group",{attrs:{"default-value":e.TaiwanDefaultValue,disabled:e.optionDisable},on:{change:e.handleChangeTaiwanEndorsement}},[i("div",{staticStyle:{display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("申请签注：")]),i("a-checkbox",{staticStyle:{flex:"1.8"},attrs:{value:"0"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.TaiwanDefaultValue.length,expression:"TaiwanDefaultValue.length"}]},[i("div",{staticStyle:{margin:"10px 0px 10px 20px",display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("签注种类：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{"default-value":e._f("TaiwanEndorsementOptions")(e.form.taiwanType),placeholder:"请选择签注种类",disabled:e.optionDisable},on:{change:e.handleChangeTaiwanOption}},e._l(e.TaiwanEndorsementOptions,(function(t,a){return i("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.TaiwanTimeShow,expression:"TaiwanTimeShow"}],staticStyle:{margin:"10px 0px 10px 20px",display:"flex"}},[i("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"flex-end"}},[e._v("签注时间：")]),i("a-select",{staticStyle:{width:"150px",flex:"1.8"},attrs:{"default-value":e._f("timeOptions")(e.form.taiwanEndorsementTime),placeholder:"请选择签注时间",disabled:e.optionDisable},on:{change:e.handleChangeTaiwanTime}},[i("a-select-option",{attrs:{value:7}},[e._v("6个月一次")]),i("a-select-option",{attrs:{value:6}},[e._v("多次有效")])],1)],1)])]):e._e()])],1)])],1)],1)],1)],1),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[e.isadd?i("a-button",{attrs:{type:"primary",loading:e.detailsLoading},on:{click:e.nextPrint}},[e._v("下一步")]):e._e(),i("a-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.current&&!e.isadd,expression:"current != 0 && !isadd"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary",loading:e.detailsLoading},on:{click:function(t){return e.saveClick(!0)}}},[e._v("修改")]),i("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleClose}},[e._v("关闭")])],1)],1)],1),i("perosonModal",{attrs:{showmodal:e.showtowmodal},on:{handleOk:e.handleOk,cancel:e.cancel}}),i("a-modal",{attrs:{visible:e.errorDetailsDialogVisible,title:"批量导入错误信息",width:"800px",destroyOnClose:"",centered:!0,footer:null},on:{cancel:function(t){e.errorDetailsDialogVisible=!1},ok:function(t){e.errorDetailsDialogVisible=!1}}},[i("a-table",{attrs:{columns:e.errorTableColumnList,"data-source":e.errorTableDataList}})],1),i("ApprovalNew",{attrs:{printData:e.printData,getList:e.searchClick,type:"spb"},on:{cancel:e.cancelSpb}}),i("ConsentLetterNew",{attrs:{printData:e.printData,reload:e.searchClick1}}),i("a-modal",{attrs:{title:"选择打印"},on:{cancel:e.printOK,ok:e.printOK},model:{value:e.visiblePrint,callback:function(t){e.visiblePrint=t},expression:"visiblePrint"}},[i("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center","margin-bottom":"20px"}},[i("div",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"center"}},[i("a-button",{on:{click:function(t){return e.print(e.modalForm)}}},[i("a-badge",{attrs:{count:"1","number-style":{backgroundColor:"#299bff"}}}),e._v("打印审批表 ")],1)],1),i("div",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"center"}},[i("a-button",{on:{click:function(t){return e.printClick(e.detailsForm)}}},[i("a-badge",{attrs:{count:"2","number-style":{backgroundColor:"#299bff"}}}),e._v("打印同意函 ")],1)],1)]),i("div",[i("p",{staticStyle:{color:"red"}},[e._v("出入境审批表默认使用A4打印纸，纵向打印。可选A3打印纸，横向打印。")]),i("p",{staticStyle:{color:"red"}},[e._v("同意函请使用A4打印纸，纵向打印。")])])]),i("a-modal",{attrs:{title:e.eleTitle,visible:e.statusDialogVisible,footer:null,okText:e.okText,width:"1200px",centered:!0},on:{cancel:e.handleCancel,ok:e.elehandleOk}},[i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("a-button",{on:{click:e.handleCancel}},[e._v("关闭")]),i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.elehandleOk}},[e._v(e._s(e.okText))])],1),e.electronic.imageUrl?i("div",{staticStyle:{"text-align":"center","font-size":"20px",color:"red"}},[e._v(" 请确认上传扫描件的单据编号是："+e._s("出国(境)审批表采集"==e.eleTitle?e.electronic.serialNumber:e.electronic.serialNumber1)+" ")]):e._e(),i("a-card",{staticClass:"card"},[i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{span:12}},[i("p",{staticClass:"title"},["出国(境)审批表采集"==e.eleTitle?i("span",{staticStyle:{"margin-right":"30px"}},[e._v("单据编号："+e._s(e.electronic.serialNumber))]):i("span",{staticStyle:{"margin-right":"30px"}},[e._v("单据编号："+e._s(e.electronic.serialNumber1))]),i("span",[e._v("姓名："+e._s(e.electronic.surname)+e._s(e.electronic.name))])]),i("a-descriptions",{attrs:{layout:"vertical",bordered:""}},[i("a-descriptions-item",{attrs:{label:"姓名"}},[e._v(e._s(e.electronic.surname)+e._s(e.electronic.name))]),i("a-descriptions-item",{attrs:{label:"公民身份证号码"}},[e._v(e._s(e._f("cardIDShade")(e.electronic.cardID)))]),i("a-descriptions-item",{attrs:{label:"工作单位"}},[e._v(e._s(e.electronic.workUnit))]),i("a-descriptions-item",{attrs:{label:"职务/职级"}},[e._v(e._s(e._f("professFilter")(e.electronic.professionalPost)))]),i("a-descriptions-item",{directives:[{name:"show",rawName:"v-show",value:"出国(境)审批表采集"==e.eleTitle,expression:"eleTitle == '出国(境)审批表采集'"}],attrs:{label:"前往国家（地区）"}},[e._v(e._s(e.electronic.destination))]),i("a-descriptions-item",{directives:[{name:"show",rawName:"v-show",value:"出国(境)审批表采集"==e.eleTitle,expression:"eleTitle == '出国(境)审批表采集'"}],attrs:{label:"出国（境）时间"}},[e._v(e._s(e.electronic.toAbroadTime))])],1)],1),i("a-col",{attrs:{span:12}},[i("div",[i("p",{staticClass:"title"},[e._v(e._s("出国(境)审批表采集"==e.eleTitle?"出国（境）审批表扫描件":"同意函扫描件"))]),i("a-upload",{staticClass:"avatar-uploader",staticStyle:{display:"flex","justify-content":"center"},attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,"before-upload":e.elelbeforeUpload,accept:".pdf"},on:{change:e.handleChange}},[i("div",[i("a-button",{class:e.electronic.imageUrl?"Upload_have":"Upload",attrs:{type:e.loading?"loading":"plus",icon:"cloud-upload"}},[i("span",{staticStyle:{display:"block","white-space":"pre-wrap"}},[e._v(e._s(e.electronic.imageUrl?"重新上传":"出国(境)审批表采集"==e.eleTitle?"请上传已签字盖章的出国（境）审批表扫描件":"请上传已签字盖章的同意函扫描件"))])])],1)]),e.electronic.imageUrl?i("embed",{attrs:{src:e.electronic.imageUrl,width:"500px",height:"500"}}):e._e()],1)])],1)],1),i("h3",{staticStyle:{color:"red","font-weight":"bolder"}},[e._v(" 重要提示：请确保上传的扫描件与审批单信息的一致性，否则会导致审批失败！ ")]),i("h4",{staticStyle:{color:"red","padding-bottom":"20px"}},[e._v(" 1：通过高拍仪拍摄后，转pdf传入系统 2：通过手机拍照后，通过软件如：CS扫描仪将文件转成pdf传入系统。 3：其他方式生产pdf文件上传系统 ")])],1),i("a-modal",{staticStyle:{"padding-bottom":"20px"},attrs:{title:"异常告警信息",visible:e.errorModal,footer:null,centered:"",width:"500px",height:"300px"},on:{cancel:e.cancel1}},[i("div",{staticStyle:{display:"flex"}},[i("a-icon",{staticStyle:{color:"rgb(232,200,5)","font-size":"70px",margin:"10px auto"},attrs:{type:"warning"}})],1),i("h3",{staticStyle:{"text-align":"center","padding-bottom":"40px"}},[e._v("异常原因:"+e._s(e.errorForm.errorInfo))])])],1)],1):e._e()},n=[],s=(a("99af"),a("a623"),a("4de4"),a("7db0"),a("c740"),a("4160"),a("caad"),a("baa5"),a("fb6a"),a("45fc"),a("b0c0"),a("a9e3"),a("b64b"),a("d3b7"),a("07ac"),a("ac1f"),a("25f0"),a("2532"),a("5319"),a("1276"),a("159b"),a("ddb0"),a("2909")),r=a("5530"),o=a("ca00"),l=a("1146"),c=a.n(l),d=a("c1df"),p=a.n(d),m=a("6262"),u=a("b775");function h(t){return Object(u["a"])({url:"/consent/electronic/info",method:"get",params:t})}function f(t){return Object(u["a"])({url:"/consent/record/info",method:"post",data:t})}function v(t){return Object(u["a"])({url:"/consent/record/printing",method:"post",data:t})}function y(t){return Object(u["a"])({url:"/consent/submit/list",method:"post",data:t})}function g(t){return Object(u["a"])({url:"/consent/record/info",method:"put",data:t})}function b(t){return Object(u["a"])({url:"/consent/electronic/info",method:"put",data:t})}function x(t){return Object(u["a"])({url:"/consent/record/info",method:"delete",data:t})}var w=function(t){return Object(u["a"])({url:"/consent/record/info",method:"get",params:t})},S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{staticClass:"modal",attrs:{width:"spb"==t.type?"90%":"70%",title:"打印",footer:null},on:{ok:t.handleOk,cancel:t.handleCancel},model:{value:t.$store.state.app.printShowNew,callback:function(e){t.$set(t.$store.state.app,"printShowNew",e)},expression:"$store.state.app.printShowNew"}},[a("div",{staticClass:"zh-tab"},[a("a-button",{attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("打印")]),a("a-button",{staticStyle:{"margin-right":"8px"},on:{click:t.handleCancel}},[t._v("取消")])],1),a("div",{staticStyle:{overflow:"auto","max-height":"70vh"}},[a("div",[a("span",[t._v("单据编号："+t._s(t.printData.serialNumber1))]),a("div",{staticStyle:{margin:"0px",width:"50px",float:"right"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t._f("creatQrCode")(t.printData.serialNumber1)}})])]),a("div",{staticStyle:{"text-align":"center",margin:"0px 20px auto"}},[a("h1",{staticStyle:{"font-weight":"700"}},[t._v("关于同意"+t._s(t.printData.surname+t.printData.name))]),a("h1",{staticStyle:{"font-weight":"700"}},[t._v("申办出入境证件的函")]),a("h2",[t._v("编号："+t._s(t.printData.orderNo))]),a("p",{staticStyle:{"text-align":"left"}},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v("杭州市公安局：")])]),a("p",{staticStyle:{"text-align":"left","text-indent":"2em","line-height":"30px"}},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name))]),t._v(" 同志（公民身份号码："+t._s(t.printData.cardID)+"）系 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.workUnit))]),t._v(" （单位全称）的 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.professionalPost))]),t._v(" （职务）。按照干部管理权限，我单位同意该人申办。 ")]),a("div",{staticStyle:{"text-align":"left",margin:"0px 20px auto"}},[a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.passHas,expression:"printData.passHas!=''"}],staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.passOption))+t._s("1"==t.printData.passHas?"普通护照":"")+"。")]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.hkHas,expression:"printData.hkHas!=''"}]},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.hkOption))+t._s("1"==t.printData.hkHas?"往来港澳通行证和签注":""))]),t._v("，签注种类为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("endorsementOptions")(t.printData.hkType)))]),t._v("， "),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.hkTime,expression:"printData.hkTime != ''"}]},[t._v(" 往来香港签注时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.hkTime)))]),t._v("。 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.macaoTime,expression:"printData.macaoTime != ''"}]},[t._v(" 往来澳门签注时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.macaoTime)))]),t._v("。 ")])]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.taiwanHas,expression:"printData.taiwanHas!=''"}]},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.taiwanOption))+t._s("1"==t.printData.taiwanHas?"往来台湾通行证和签注":""))]),t._v("，签注种类为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("endorsementOptions")(t.printData.taiwanType)))]),t._v("，往来台湾时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.taiwanEndorsementTime)))]),t._v("。 ")])]),a("div",{staticStyle:{"text-align":"left","margin-top":"50px"}},[a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"right"}},[t._v("组织、人事部门联系人姓名：")]),a("span",{staticStyle:{flex:"2"}},[t._v(t._s(t.printData.jobContact))])]),a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"right"}},[t._v("联系电话：")]),a("span",{staticStyle:{flex:"2"}},[t._v(t._s(t.printData.jobPhoneNumber))])])]),a("div",{staticStyle:{"text-align":"left","margin-top":"50px"}},[a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"left"}},[t._v("负责人签名：")]),a("span",{staticStyle:{flex:"1"}},[t._v("公章：")])]),a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"left"}}),a("span",{staticStyle:{flex:"1"}},[t._v(" 日期： "),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s((new Date).getFullYear()))]),t._v("年 "),t._v(" 年 ")]),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(((new Date).getMonth()+1).toString().length>1?(new Date).getMonth()+1:"0"+((new Date).getMonth()+1)))]),t._v("月 ")]),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s((new Date).getDate()))]),t._v("日 ")])])])]),a("div",{staticStyle:{"text-align":"left"}},[a("p",[a("span",[t._v("备注：")]),t._v("1、登记备案国家工作人员申请出入境证件须提交此函，如有涂改，本函无效。 ")]),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("2、本函自开具之日3个月内有效。")]),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("签注。特别说明：")]),a("p",{staticStyle:{width:"92%","border-bottom":"1px solid #000",margin:"40px 0px 0px 45px"}}),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("（请文字说明并加盖公章）")])])]),a("iframe",{ref:"printIframe",staticStyle:{margin:"0px","margin-left":"20px",padding:"0px",width:"0px",height:"0px"},attrs:{frameborder:"0",scrolling:"no"}}),a("div",{ref:"odiv",staticStyle:{display:"none"}},[a("div",[a("span",[t._v("单据编号："+t._s(t.printData.serialNumber1))]),a("div",{staticStyle:{margin:"0px",width:"50px",float:"right"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t._f("creatQrCode")(t.printData.serialNumber1)}})])]),a("div",{staticStyle:{"text-align":"center",margin:"0px 20px auto"}},[a("h1",{staticStyle:{"font-weight":"700"}},[t._v("关于同意"+t._s(t.printData.surname+t.printData.name))]),a("h1",{staticStyle:{"font-weight":"700"}},[t._v("申办出入境证件的函")]),a("h2",[t._v("编号："+t._s(t.printData.orderNo))]),a("p",{staticStyle:{"text-align":"left"}},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v("杭州市公安局")])]),a("p",{staticStyle:{"text-align":"left","text-indent":"2em","line-height":"30px"}},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name))]),t._v(" 同志（公民身份号码："+t._s(t.printData.cardID)+"）系 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.workUnit))]),t._v(" （单位全称）的 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.professionalPost))]),t._v(" （职务）。按照干部管理权限，我单位同意该人申办。 ")]),a("div",{staticStyle:{"text-align":"left",margin:"0px 20px auto"}},[a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.passHas,expression:"printData.passHas!=''"}],staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.passOption))+t._s("1"==t.printData.passHas?"普通护照":"")+"。")]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.hkHas,expression:"printData.hkHas!=''"}]},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.hkOption))+t._s("1"==t.printData.hkHas?"往来港澳通行证和签注":""))]),t._v("，签注种类为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("endorsementOptions")(t.printData.hkType)))]),t._v("， "),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.hkTime,expression:"printData.hkTime != ''"}]},[t._v(" 往来香港签注时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.hkTime)))]),t._v("。 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.macaoTime,expression:"printData.macaoTime != ''"}]},[t._v(" 往来澳门签注时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.macaoTime)))]),t._v("。 ")])]),a("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.printData.taiwanHas,expression:"printData.taiwanHas!=''"}]},[a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.printData.surname+t.printData.name)+t._s(t._f("passOptions")(t.printData.taiwanOption))+t._s("1"==t.printData.taiwanHas?"往来台湾通行证和签注":""))]),t._v("，签注种类为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("endorsementOptions")(t.printData.taiwanType)))]),t._v("，往来台湾时间为 "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t._f("timeOptions")(t.printData.taiwanEndorsementTime)))]),t._v("。 ")])]),a("div",{staticStyle:{"text-align":"left","margin-top":"50px"}},[a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"right"}},[t._v("组织、人事部门联系人姓名：")]),a("span",{staticStyle:{flex:"2"}},[t._v(t._s(t.printData.jobContact))])]),a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"right"}},[t._v("联系电话：")]),a("span",{staticStyle:{flex:"2"}},[t._v(t._s(t.printData.jobPhoneNumber))])])]),a("div",{staticStyle:{"text-align":"left","margin-top":"50px"}},[a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"left"}},[t._v("负责人签名：")]),a("span",{staticStyle:{flex:"1"}},[t._v("公章：")])]),a("p",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{flex:"1","text-align":"left"}}),a("span",{staticStyle:{flex:"1"}},[t._v(" 日期： "),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s((new Date).getFullYear()))]),t._v("年 "),t._v(" 年 ")]),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(((new Date).getMonth()+1).toString().length>1?(new Date).getMonth()+1:"0"+(new Date).getMonth()))]),t._v("月 ")]),a("span",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s((new Date).getDate()))]),t._v("日 ")])])])]),a("div",{staticStyle:{"text-align":"left"}},[a("p",[a("span",[t._v("备注：")]),t._v("1、登记备案国家工作人员申请出入境证件须提交此函，如有涂改，本函无效。 ")]),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("2、本函自开具之日3个月内有效。")]),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("签注。特别说明：")]),a("p",{staticStyle:{width:"92%","border-bottom":"1px solid #000",margin:"40px 0px 0px 45px"}}),a("p",{staticStyle:{"text-indent":"3em"}},[t._v("（请文字说明并加盖公章）")])])])])])])],1)},_=[],D=a("e0d33"),k=a.n(D),T={1:{label:"首次申领"},3:{label:"换发"},5:{label:"已有证件"}},F={props:{printing:Function,cancel:Function,type:String,state:String,printData:{type:Object},reload:{type:Function}},filters:{passOptions:function(t){return t?T[t].label:"请选择"},certificateType:function(t){var e={1:{label:"普通护照"},2:{label:"往来港澳通行证和签注"},3:{label:"往来台湾通行证和签注"}};return t?e[t].label:"请选择"},endorsementOptions:function(t){var e={1:{label:"团队旅游"},2:{label:"个人旅游"},3:{label:"商务"},4:{label:"探亲"},5:{label:"逗留"},6:{label:"其他"}};return t?e[t].label:"请选择"},TaiwanEndorsementOptions:function(t){var e={1:{label:"团队旅游"},2:{label:"个人旅游"},3:{label:"商务"},4:{label:"探亲"},5:{label:"应邀"},6:{label:"定居"},7:{label:"学习"},8:{label:"乘务"},9:{label:"其他"}};return t?e[t].label:"请选择"},timeOptions:function(t){var e={1:{label:"3个月一次"},2:{label:"3个月二次"},3:{label:"3个月多次"},4:{label:"1年一次"},5:{label:"1年二次"},6:{label:"1年多次"},7:{label:"多次有效"},8:{label:"6个月一次"}};return t?e[t].label:"请选择"},creatQrCode:function(t){if(t){var e=2,a="L";k.a.stringToBytes=k.a.stringToBytesFuncs["UTF-8"];var i=k()(e,a);return i.addData(t,"Byte"),i.make(),i.createDataURL(2,0)}}},data:function(){return{}},computed:{},created:function(){},mounted:function(){},watch:{},methods:{handleOk:function(){document.title="同意函 - 报备审批和证件领用",this.$store.commit("SET_PRINTSHOWNEW",!1),this.postConsentRecordPrinting(),this.printpage()},handleCancel:function(){this.cancel&&this.cancel(),this.$store.commit("SET_PRINTSHOWNEW",!1)},printpage:function(){var t=this.$refs.printIframe,e=this.$refs.odiv.innerHTML;t.setAttribute("srcdoc",e),t.onload=function(){t.contentWindow.document.body.style.padding="0px",t.contentWindow.document.body.style.margin="0px",t.contentWindow.focus(),t.contentWindow.print()}},postConsentRecordPrinting:function(){var t=this,e={orderNo:this.printData.orderNo};v(e).then((function(e){t.reload()}))}},components:{}},O=F,C=(a("16f3"),a("2877")),N=Object(C["a"])(O,S,_,!1,null,"2395dc4b",null),P=N.exports,I=a("e56e"),j=a("7b0a"),$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{footer:null,width:"1000px"},on:{cancel:t.cancel},model:{value:t.isshow,callback:function(e){t.isshow=e},expression:"isshow"}},[a("a-card",{staticStyle:{width:"100%"},attrs:{bordered:!1}},[a("div",[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{staticClass:"fold"},[a("a-row",[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{labelCol:{span:6},wrapperCol:{span:16},label:"快速搜索"}},[a("a-input",{attrs:{placeholder:"请输入：姓名\\公民身份号码"},on:{change:t.search},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])],1)],1)])],1),a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:t.pagination},scopedSlots:t._u([{key:"allname",fn:function(e,i){return a("span",{},[t._v(t._s(i.surname)+t._s(i.name))])}},{key:"passport",fn:function(t){return a("span",{},[a("a-icon","0"!==t?{attrs:{type:"check"}}:{attrs:{type:"close"}})],1)}},{key:"professionalPost",fn:function(e,i){return a("span",{},[t._v(t._s(t._f("professFilter")(i.professionalPost)))])}},{key:"exitEntryPermitForHKMacao",fn:function(t){return a("span",{},[a("a-icon","0"!==t?{attrs:{type:"check"}}:{attrs:{type:"close"}})],1)}},{key:"exitEntryPermitForTW",fn:function(t){return a("span",{},[a("a-icon","0"!==t?{attrs:{type:"check"}}:{attrs:{type:"close"}})],1)}},{key:"action",fn:function(e,i){return a("span",{staticClass:"action"},[[a("a",{on:{click:function(e){return t.handleOk(i)}}},[t._v("确认")])]],2)}}])})],1)],1)],1)},E=[],H=a("166e"),L=[{title:"姓名",width:100,align:"center",dataIndex:"allname",scopedSlots:{customRender:"allname"}},{title:"公民身份号码",dataIndex:"cardID",width:150,align:"center",scopedSlots:{customRender:"cardID"}},{title:"工作单位",dataIndex:"workUnit",width:120,align:"center"},{title:"职务/职级",dataIndex:"professionalPost",width:100,align:"center",scopedSlots:{customRender:"professionalPost"}},{title:"性别",dataIndex:"sex",width:120,align:"center"},{title:"护照",dataIndex:"passport",width:100,align:"center",scopedSlots:{customRender:"passport"}},{title:"港澳通行证",dataIndex:"exitEntryPermitForHKMacao",width:150,align:"center",scopedSlots:{customRender:"exitEntryPermitForHKMacao"}},{title:"台湾通行证",dataIndex:"exitEntryPermitForTW",width:150,align:"center",scopedSlots:{customRender:"exitEntryPermitForTW"}},{title:"操作",dataIndex:"action",width:100,align:"center",scopedSlots:{customRender:"action"}}],A=[],R={props:{showmodal:{type:Boolean,default:!1},type:{type:String,default:"已报备"}},data:function(){var t=this;return{columns:L,dataSource:[],selectValue:"",direction:"1",pagination:{current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showTotal:function(e){return"共 ".concat(e," 条记录 第").concat(t.pagination.current,"/").concat(Math.ceil(e/t.pagination.pageSize),"页")},onChange:function(e,a){t.pagination.current=e,t.getList()},onShowSizeChange:function(e,a){t.pagination.pageSize=a,t.getList()}}}},computed:{isshow:{get:function(){return this.getList(),this.showmodal},set:function(){}}},created:function(){var t=this;Object(I["c"])().then((function(e){A=e.data.list,t.getList()}))},filters:{professFilter:function(t){return Object.values(A).find((function(e){return e.value===t})).label}},methods:{getList:function(){var t=this,e={pageNo:this.pagination.current,pageSize:this.pagination.pageSize,selectValue:this.selectValue,direction:this.direction,isInRegistries:"已报备"===this.type?"1":void 0,state:this.statevalue,isInWhite:"白名单"===this.type?"0":void 0};Object(H["h"])(e).then((function(e){t.dataSource=[],null!==e.data.list&&e.data.list.length>0?(t.dataSource=e.data.list,t.pagination.total=Number(e.data.total)):t.pagination.total=0}))},handleOk:function(t){this.selectValue="",this.$emit("handleOk",t)},cancel:function(){this.selectValue="",this.$emit("cancel")},search:function(){this.pagination.current=1,this.getList()}}},M=R,V=Object(C["a"])(M,$,E,!1,null,"2ceaddda",null),K=V.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"单据编号:"}},[a("a-input",{attrs:{placeholder:"系统自动分配",disabled:""},model:{value:t.modalForm.orderNo,callback:function(e){t.$set(t.modalForm,"orderNo",e)},expression:"modalForm.orderNo"}})],1),a("a-row",[a("a-col",{attrs:{span:18}},[a("a-form-model-item",{attrs:{label:"姓名:","label-col":{span:8},"wrapper-col":{span:14}}},[a("a-input",{attrs:{placeholder:"请输入姓名",disabled:""},model:{value:t.modalForm.fullName,callback:function(e){t.$set(t.modalForm,"fullName",e)},expression:"modalForm.fullName"}})],1)],1),t.modalForm.state==t.statelist["ADD"].value&&t.isadd?a("a-col",{attrs:{span:1}},[a("a-button",{staticStyle:{"margin-top":"4px"},attrs:{type:"primary"},on:{click:t.showpersonModal}},[t._v("...")])],1):t._e()],1),a("a-form-model-item",{attrs:{label:"性别:"}},[a("a-radio-group",{attrs:{disabled:""},model:{value:t.modalForm.sex,callback:function(e){t.$set(t.modalForm,"sex",e)},expression:"modalForm.sex"}},[a("a-radio",{attrs:{value:"男"}},[t._v("男")]),a("a-radio",{attrs:{value:"女"}},[t._v("女")]),a("a-radio",{attrs:{value:"未知"}},[t._v("未知")])],1)],1),a("a-form-model-item",{attrs:{label:"公民身份号码:"}},[a("a-input",{attrs:{disabled:""},model:{value:t.modalForm.cardID,callback:function(e){t.$set(t.modalForm,"cardID",e)},expression:"modalForm.cardID"}})],1),a("a-form-model-item",{attrs:{label:"本人手机号码:"}},[a("a-input",{attrs:{disabled:""},model:{value:t.modalForm.myPhone,callback:function(e){t.$set(t.modalForm,"myPhone",e)},expression:"modalForm.myPhone"}})],1),a("a-row",[a("a-col",{attrs:{span:13}},[a("a-form-model-item",{attrs:{label:"出生日期:","label-col":{span:11},"wrapper-col":{span:13}}},[a("a-date-picker",{attrs:{disabled:""},model:{value:t.modalForm.birthday,callback:function(e){t.$set(t.modalForm,"birthday",e)},expression:"modalForm.birthday"}})],1)],1),a("a-col",{attrs:{span:11}},[a("a-form-model-item",{attrs:{label:"单位:","label-col":{span:9},"wrapper-col":{span:11}}},[a("a-input",{attrs:{disabled:""},model:{value:t.modalForm.workUnit,callback:function(e){t.$set(t.modalForm,"workUnit",e)},expression:"modalForm.workUnit"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"职务/职级:",prop:"professionalPost"}},[a("a-select",{attrs:{disabled:""},model:{value:t.modalForm.professionalPost,callback:function(e){t.$set(t.modalForm,"professionalPost",e)},expression:"modalForm.professionalPost"}},t._l(t.professionalList,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),a("a-row",[a("a-col",{attrs:{span:13}},[a("a-form-model-item",{attrs:{label:"民族:","label-col":{span:11},"wrapper-col":{span:13},prop:"nation"}},[a("a-input",{attrs:{disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.nation,callback:function(e){t.$set(t.modalForm,"nation",e)},expression:"modalForm.nation"}})],1)],1),a("a-col",{attrs:{span:11}},[a("a-form-model-item",{attrs:{label:"籍贯:","label-col":{span:9},"wrapper-col":{span:11},prop:"nativePlace"}},[a("a-input",{attrs:{disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.nativePlace,callback:function(e){t.$set(t.modalForm,"nativePlace",e)},expression:"modalForm.nativePlace"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:13}},[a("a-form-model-item",{attrs:{label:"参加党团时间:","label-col":{span:11},"wrapper-col":{span:13},prop:"joinPartyDay"}},[a("a-date-picker",{attrs:{"disabled-date":t.disabledDate,disabled:0==t.current&&!t.isadd||t.isjoinParty},on:{change:t.changejoinPartyDay},model:{value:t.modalForm.joinPartyDay,callback:function(e){t.$set(t.modalForm,"joinPartyDay",e)},expression:"modalForm.joinPartyDay"}})],1)],1),a("a-col",{attrs:{span:11}},[a("a-form-model-item",{attrs:{label:"学历:","label-col":{span:9},"wrapper-col":{span:11},prop:"education"}},[a("a-select",{attrs:{allowClear:"",disabled:0==t.current&&!t.isadd,placeholder:"请选择学历"},model:{value:t.modalForm.education,callback:function(e){t.$set(t.modalForm,"education",e)},expression:"modalForm.education"}},t._l(t.educationList,(function(e){return a("a-select-option",{key:e.label,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:13}},[a("a-form-model-item",{attrs:{label:"参加工作时间:","label-col":{span:11},"wrapper-col":{span:13},prop:"workday"}},[a("a-date-picker",{attrs:{"disabled-date":t.disabledDate,disabled:0==t.current&&!t.isadd},on:{change:t.changeworkday},model:{value:t.modalForm.workday,callback:function(e){t.$set(t.modalForm,"workday",e)},expression:"modalForm.workday"}})],1)],1),a("a-col",{attrs:{span:11}},[a("a-form-model-item",{attrs:{label:"健康状况:","label-col":{span:9},"wrapper-col":{span:11},prop:"health"}},[a("a-select",{attrs:{allowClear:"",disabled:0==t.current&&!t.isadd,placeholder:"请选择健康状态"},model:{value:t.modalForm.health,callback:function(e){t.$set(t.modalForm,"health",e)},expression:"modalForm.health"}},[a("a-select-option",{attrs:{value:"健康"}},[t._v("健康")]),a("a-select-option",{attrs:{value:"不健康"}},[t._v("不健康")])],1)],1)],1)],1),a("a-form-model-item",{attrs:{label:"何时离(退)休:",prop:"retirementTime"}},[a("a-date-picker",{attrs:{disabled:0==t.current&&!t.isadd,"disabled-date":t.disabledDateafter,placeholder:"请选择退休日期"},on:{change:t.changeretirementTimeDate},model:{value:t.modalForm.retirementTime,callback:function(e){t.$set(t.modalForm,"retirementTime",e)},expression:"modalForm.retirementTime"}})],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"国外通讯处:","label-col":{span:12},"wrapper-col":{span:12},prop:"zhAddress"}},[a("a-input",{attrs:{disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.zhAddress,callback:function(e){t.$set(t.modalForm,"zhAddress",e)},expression:"modalForm.zhAddress"}})],1)],1),a("a-col",{attrs:{span:3}},[a("span",{staticStyle:{"line-height":"40px"}},[t._v("（中文）")])]),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{staticClass:"enAddress",attrs:{prop:"enAddress"}},[a("a-input",{attrs:{disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.enAddress,callback:function(e){t.$set(t.modalForm,"enAddress",e)},expression:"modalForm.enAddress"}})],1)],1),a("a-col",{attrs:{span:3}},[a("span",{staticStyle:{"line-height":"40px"}},[t._v("（英文）")])])],1),a("a-form-model-item",{attrs:{label:"代办人姓名:",prop:"attorneys"}},[a("a-input",{attrs:{placeholder:"请输入代办人姓名","max-lenght":32,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.attorneys,callback:function(e){t.$set(t.modalForm,"attorneys",e)},expression:"modalForm.attorneys"}})],1),a("a-form-model-item",{attrs:{label:"代办人手机:",prop:"attorneysPhone"}},[a("a-input",{attrs:{placeholder:"请输入代办人手机","max-length":11,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.attorneysPhone,callback:function(e){t.$set(t.modalForm,"attorneysPhone",e)},expression:"modalForm.attorneysPhone"}})],1),a("a-form-model-item",{attrs:{label:"出国（境）目的地:",prop:"destination","label-col":{span:7},"wrapper-col":{span:14}}},[a("a-input",{attrs:{placeholder:"请输入出国（境）目的地","max-lenght":128,disabled:0==t.current&&!t.isadd},on:{change:t.destination},model:{value:t.modalForm.destination,callback:function(e){t.$set(t.modalForm,"destination",e)},expression:"modalForm.destination"}})],1),a("a-form-model-item",{attrs:{label:"出国（境）时间:",prop:"toAbroadTime","label-col":{span:7},"wrapper-col":{span:12}}},[a("a-date-picker",{attrs:{"disabled-date":t.disabledDateafter,disabled:0==t.current&&!t.isadd},on:{change:t.changeAbroad},model:{value:t.modalForm.toAbroadTime,callback:function(e){t.$set(t.modalForm,"toAbroadTime",e)},expression:"modalForm.toAbroadTime"}})],1),a("a-form-model-item",{attrs:{label:"停留时间:",prop:"residenceTime"}},[a("a-input",{attrs:{"max-length":4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.residenceTime,callback:function(e){t.$set(t.modalForm,"residenceTime",e)},expression:"modalForm.residenceTime"}})],1),a("a-form-model-item",{attrs:{label:"同行人员:",prop:"accompanier"}},[a("a-input",{attrs:{placeholder:"请输入同行人员","max-lenght":32,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.accompanier,callback:function(e){t.$set(t.modalForm,"accompanier",e)},expression:"modalForm.accompanier"}})],1)],1),a("a-col",{attrs:{span:12}},[a("div",{staticClass:"rightcol"},[a("a-form-model-item",{attrs:{label:"上次因私出国（境）地点:",prop:"lastTimeToAbroad",labelCol:{span:6},"wrapper-col":{span:12,offset:1}}},[a("a-input",{staticStyle:{"margin-top":"20px"},attrs:{placeholder:"请输入上次因私出国（境）地点，没有可填写无","max-lenght":128,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.lastTimeToAbroad,callback:function(e){t.$set(t.modalForm,"lastTimeToAbroad",e)},expression:"modalForm.lastTimeToAbroad"}})],1),a("a-form-model-item",{attrs:{label:"上次因私出国（境）时间:",prop:"lastTimeToAbroadTime","wrapper-col":{span:12,offset:1}}},[a("a-date-picker",{staticStyle:{"margin-top":"20px"},attrs:{"disabled-date":t.disabledDate,disabled:0==t.current&&!t.isadd},on:{change:t.changelastAbroad},model:{value:t.modalForm.lastTimeToAbroadTime,callback:function(e){t.$set(t.modalForm,"lastTimeToAbroadTime",e)},expression:"modalForm.lastTimeToAbroadTime"}})],1)],1),a("a-form-model-item",{attrs:{label:"申请出国（境）事由",prop:"abroadReason","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,"max-lenght":512,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.abroadReason,callback:function(e){t.$set(t.modalForm,"abroadReason",e)},expression:"modalForm.abroadReason"}})],1),a("a-form-model-item",{attrs:{label:"费用自理情况",prop:"selfCare","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.selfCare,callback:function(e){t.$set(t.modalForm,"selfCare",e)},expression:"modalForm.selfCare"}})],1),a("a-form-model-item",{attrs:{label:"工作简历",prop:"resume","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.resume,callback:function(e){t.$set(t.modalForm,"resume",e)},expression:"modalForm.resume"}})],1),a("a-form-model-item",{attrs:{label:"国内直系亲属及主要社会关系情况",prop:"domesticRelatives","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.domesticRelatives,callback:function(e){t.$set(t.modalForm,"domesticRelatives",e)},expression:"modalForm.domesticRelatives"}})],1),a("a-form-model-item",{attrs:{label:"国外直系亲属及主要社会关系情况",prop:"abroadRelatives","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.abroadRelatives,callback:function(e){t.$set(t.modalForm,"abroadRelatives",e)},expression:"modalForm.abroadRelatives"}})],1),a("a-form-model-item",{attrs:{label:"政治表现",prop:"political","wrapper-col":{span:15,offset:1}}},[a("a-textarea",{attrs:{rows:4,disabled:0==t.current&&!t.isadd},model:{value:t.modalForm.political,callback:function(e){t.$set(t.modalForm,"political",e)},expression:"modalForm.political"}})],1),a("a-form-model-item",{staticClass:"credentials",attrs:{label:"需申领证件",prop:"credentials","wrapper-col":{span:15,offset:1}}},[a("a-radio-group",{attrs:{name:"checkboxgroup",options:t.plainOptions,disabled:t.optionDisable},on:{change:t.credentials},model:{value:t.modalForm.credentials,callback:function(e){t.$set(t.modalForm,"credentials",e)},expression:"modalForm.credentials"}})],1),a("a-form-model-item",{staticStyle:{display:"flex","justify-content":"flex-end"}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:"4"!=t.metaType&&!t.metaTypeDetail,expression:"metaType!='4'&&!metaTypeDetail"}],attrs:{type:"primary",loading:t.isloading},on:{click:function(e){return t.nextConsentLetter()}}},[t._v(t._s("出国（境）审批表详细信息"==t.modalTitle?"同意函详情":"下一步"))]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:"4"==t.metaType&&!t.metaTypeDetail,expression:"metaType=='4'&&!metaTypeDetail"}],attrs:{type:"primary",loading:t.isloading},on:{click:function(e){return t.nextConsentLetter()}}},[t._v("下一步")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:0!=t.current&&!t.isadd,expression:"current != 0 && !isadd"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary",loading:t.isloading},on:{click:function(e){return t.putapplicationForm()}}},[t._v("修改")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:1==t.current&&t.modalForm.state==t.statelist["PRINTED"].value,expression:"current == 1 && modalForm.state == statelist['PRINTED'].value"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.print(t.modalForm)}}},[t._v("打印")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:2==t.current&&!t.isadd,expression:"current == 2 && !isadd"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.rePrint}},[t._v("重新打印")]),a("a-popconfirm",{attrs:{title:"你确定要作废?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(e){return t.deleteForm()},cancel:t.cancel1}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:!t.isadd&&0!=t.current,expression:"!isadd && current != 0"}],staticStyle:{"margin-left":"10px"},attrs:{type:"danger",loading:t.isloading}},[t._v("作废")])],1),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.closemodal}},[t._v("关闭")]),a("input",{ref:"excel-upload-input",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleClick}})],1)],1)],1)},U=[],z={data:function(){return{statelist:{ADD:{value:"1",text:"新增",color:"gold"},PRINTED:{value:"4",text:"已打印",color:"gold"},SUBMITTED:{value:"6",text:"已提交",color:"gold"},SUCCESSFUL_FILING:{value:"8",text:"备案成功",color:"green"}},plainOptions:[{label:"普通护照",value:"1",disabled:!0},{label:"往来港澳通行证及签注",value:"2",disabled:!0},{label:"往来台湾通行证及签注",value:"3",disabled:!0}],excelData:{},excelColumns:[{header:"人员身份证号码（必填）",key:"cardID",width:20,style:{numFmt:"@"}},{header:"籍贯（必填）",key:"nativePlace",width:20,style:{numFmt:null}},{header:"民族（必填）",key:"nation",width:20},{header:"健康状态（必填）",key:"health",width:20},{header:"工作日期（必填）",key:"workday",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"入党日期",key:"joinPartyDay",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"学历（必填）",key:"education",width:20,style:{numFmt:null}},{header:"退休日期（必填）",key:"retirementTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"代办人（必填）",key:"attorneys",width:20,style:{numFmt:null}},{header:"代办人手机号（必填）",key:"attorneysPhone",width:20},{header:"出国事由（必填）",key:"abroadReason",width:20},{header:"前往国家，目的地（必填）",key:"destination",width:20},{header:"出国时间（必填）",key:"toAbroadTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"停留时间(天)（必填）",key:"residenceTime",width:20,style:{numFmt:null}},{header:"同行人员（必填）",key:"accompanier",width:20},{header:"上次因私出国地点（必填）",key:"lastTimeToAbroad",width:20},{header:"上次因私出国时间（必填）",key:"lastTimeToAbroadTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"领用证件（必填）",key:"credentials",width:20,style:{numFmt:null}},{header:"中文通讯地址（必填）",key:"zhAddress",width:20},{header:"英文通讯地址（必填）",key:"enAddress",width:20},{header:"费用自理情况（必填）",key:"selfCare",width:40},{header:"工作简历（必填）",key:"resume",width:40},{header:"国内直系亲属及主要社会关系情况（必填）",key:"domesticRelatives",width:40},{header:"国外直系亲属及主要社会关系情况（必填）",key:"abroadRelatives",width:40},{header:"政治表现（必填）",key:"political",width:40},{header:"备注信息",key:"attach",width:20}]}},props:{modalForm:{type:Object,default:function(){return{}}},modalTitle:{type:String,default:""},current:{type:Number,default:0},isadd:{type:Boolean,default:!1},isjoinParty:{type:Boolean,default:!1},educationList:{type:Array,default:function(){return[]}},professionalList:{type:Array,default:function(){return[]}},optionDisable:{type:Boolean,default:!1},isloading:{type:Boolean,default:!1},metaType:{type:String,default:""},metaTypeDetail:{type:Boolean,default:!1}},methods:{destination:function(){this.modalForm.destination.includes("香港")||this.modalForm.destination.includes("澳门")?(this.plainOptions[1].disabled=!1,this.modalForm.credentials="2",this.plainOptions[1].disabled||(this.plainOptions[0].disabled=!0,this.plainOptions[2].disabled=!0)):this.modalForm.destination.includes("台湾")?(this.plainOptions[2].disabled=!1,this.modalForm.credentials="3",this.plainOptions[2].disabled||(this.plainOptions[0].disabled=!0,this.plainOptions[1].disabled=!0)):""==this.modalForm.destination?(this.modalForm.credentials=void 0,this.plainOptions[0].disabled=!0,this.plainOptions[1].disabled=!0,this.plainOptions[2].disabled=!0):(this.modalForm.credentials="1",this.plainOptions[0].disabled=!1,this.plainOptions[1].disabled=!0,this.plainOptions[2].disabled=!0,this.$route.path.includes("/approvManagement/endorsement")&&(this.plainOptions[0].disabled=!0,this.modalForm.credentials=void 0))},credentials:function(){},showpersonModal:function(){this.$emit("showpersonModal")},putapplicationForm:function(){this.$emit("putapplicationForm")},changejoinPartyDay:function(t,e){this.modalForm.joinPartyDay=e},changeAbroad:function(t,e){this.modalForm.toAbroadTime=e},changeworkday:function(t,e){this.modalForm.workday=e},changeretirementTimeDate:function(t,e){this.modalForm.retirementTime=e},changelastAbroad:function(t,e){this.modalForm.lastTimeToAbroadTime=e},nextConsentLetter:function(){this.$emit("nextConsentLetter")},print:function(t){this.$emit("print",t)},rePrint:function(){this.$emit("rePrint")},deleteForm:function(){this.$emit("deleteForm")},closemodal:function(){this.$emit("closemodal")},pushData:function(){this.$emit("pushData")},cancel:function(){this.modalForm={},this.$emit("cancelApprov")},cancel1:function(){this.$emit("cancel")},disabledDate:function(t){return t&&t>p()().endOf("day")},disabledDateafter:function(t){return t&&t<p()().endOf("day")},handleSuccess:function(){var t=this.excelData.results;if(0===t.length)return this.uploading=!1,this.$message.warning("请选择有数据的excel");var e=t[0];e.joinPartyDay=p()(parseInt(e.joinPartyDay)).format("YYYY-MM-DD"),this.modalForm=Object(r["a"])({},e)},batchImportClick:function(){this.$emit("batchImportClick")},generateData:function(t){var e=t.header,a=t.results;this.excelData.header=e,this.excelData.results=a,this.handleSuccess()},handleClick:function(t){this.$emit("handleClick")},upload:function(t){this.readerData(t)},readerData:function(t){var e=this;this.uploading=!0;var a=new FileReader;a.onload=function(t){var a=t.target.result,i=c.a.read(a,{type:"array",dateNF:"yyyy-mm-dd"}),n=i.SheetNames[0],s=i.Sheets[n],r=e.getHeaderRow(s),o=e.getJsonData(s),l=o.filter((function(t){return!1===t.satify}));e.$refs["excel-upload-input"].value="",l.length>0?(e.errorTableDataList=l,e.errorDetailsDialogVisible=!0,e.uploading=!1,o=o.filter((function(t){return!0===t.satify})),e.generateData({header:r,results:o})):o.length>0?e.generateData({header:r,results:o}):(e.$message.warning("请选择有数据的excel"),e.uploading=!1)},a.readAsArrayBuffer(t)},getHeaderRow:function(t){var e,a=[],i=c.a.utils.decode_range(t["!ref"]),n=i.s.r;for(e=i.s.c;e<=i.e.c;++e){var s=t[c.a.utils.encode_cell({c:e,r:n})],r="UNKNOWN "+e;s&&s.t&&(r=c.a.utils.format_cell(s)),a.push(r)}return this.excelData.header=a,a},getJsonData:function(t){for(var e=this,a=[],i=["cardID","nativePlace","nation","health","workday","joinPartyDay","education","retirementTime","attorneys","attorneysPhone","abroadReason","destination","toAbroadTime","residenceTime","accompanier","lastTimeToAbroad","lastTimeToAbroadTime","credentials","zhAddress","enAddress","selfCare","resume","domesticRelatives","abroadRelatives","political","attach"],n=[0,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],s=c.a.utils.decode_range(t["!ref"]),o={},l=function(l){for(var d={unSuccessInfo:"",satify:!0},m=function(a){var n=t[c.a.utils.encode_cell({c:a,r:l})];switch(d[i[a]]=c.a.utils.format_cell(n),i[a]){case"cardID":d[i[a]]=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|31)|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}([0-9]|x|X)$/.test(d[i[a]])?d[i[a]]:"",o[d[i[a]]]&&(d.unSuccessInfo="重复的公民身份号码"),o[d[i[a]]]=!0;break;case"workday":case"joinPartyDay":case"lastTimeToAbroadTime":d[i[a]]=/^\d{4}\/\d{2}\/\d{2}$/.test(d[i[a]])&&p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf()&&p()(d[i[a]],"YYYY-MM-DD").endOf("day").valueOf()<p()().endOf("day").valueOf()?p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf().toString():"";break;case"retirementTime":case"toAbroadTime":d[i[a]]=/^\d{4}\/\d{2}\/\d{2}$/.test(d[i[a]])&&p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf()&&p()(d[i[a]],"YYYY-MM-DD").endOf("day").valueOf()>p()().endOf("day").valueOf()?p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf().toString():"";break;case"attorneysPhone":d[i[a]]=/^[1][3-9][0-9]{9}$/.test(d[i[a]])?d[i[a]]:"";break;case"residenceTime":d[i[a]]=Number(d[i[a]])?d[i[a]]:"";break;case"credentials":var s=e.plainOptions.find((function(t){return d[i[a]]===t.label}));d[i[a]]=s?s.value:"";break;case"nativePlace":case"nation":case"attorneys":case"accompanier":d[i[a]]=/^[\u4e00-\u9fa5]+$/.test(d[i[a]])?d[i[a]]:"";break;case"health":d[i[a]]="健康"===d[i[a]]||"不健康"===d[i[a]]?d[i[a]]:"";break;case"education":var r=e.educationList.find((function(t){return d[i[a]]===t.label}));d[i[a]]=r?r.value:"";break;case"enAddress":d[i[a]]=/^[\u4e00-\u9fa5]+$/.test(d[i[a]])?"":d[i[a]];default:break}},u=s.s.c;u<=s.e.c;++u)m(u);d.unSuccessInfo&&(d.unSuccessInfo+="，第".concat(l,"行以下列出现错误："),d.satify=!1);for(var h=0;h<n.length;h++){var f=n[h];if(!d[i[f]]){d.satify=!1,d.unSuccessInfo||(d.unSuccessInfo="第".concat(l,"行以下列的出现错误："));try{if(e.excelData.header[f]!==e.excelColumns[f].header)throw!1;d.unSuccessInfo+="".concat(e.excelColumns[f].header.replace("（必填）",""),"，")}catch(y){d.unSuccessInfo="请使用正确的模板";break}}}d.unSuccessInfo.lastIndexOf("：")===d.unSuccessInfo.length-1&&(d.unSuccessInfo=d.unSuccessInfo.replace("第".concat(l,"行以下列出现错误："),"")),d.unSuccessInfo.lastIndexOf("，")===d.unSuccessInfo.length-1&&(d.unSuccessInfo=d.unSuccessInfo.slice(0,d.unSuccessInfo.length-1));var v=Object(r["a"])({},d);delete v.unSuccessInfo,Object.values(v).every((function(t){return 0==t}))?d.satify=!1:a.push(d)},d=s.s.r+1;d<=s.e.r;++d)l(d);return a}}},q=z,B=(a("ecb3"),Object(C["a"])(q,Y,U,!1,null,"69a163ee",null)),W=B.exports,J=a("a383"),Q=a("81b6"),G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("print",{attrs:{loading:t.loading,printing:t.postPackagePrinting,type:t.type}},[[a("div",{staticStyle:{display:"flex",height:"100vh",width:"100%"}},[a("div",{staticStyle:{flex:"1","margin-top":"5vh",height:"100vh"}},[a("table",{staticStyle:{margin:"0 auto","border-collapse":"collapse",padding:"2px"},attrs:{border:"1"}},[a("tr",{staticStyle:{"border-bottom":"1px solid #000"}},[a("th",{staticStyle:{height:"26vh",width:"120px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",border:"none",padding:"20px"}},[a("span",[t._v("所在")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("单位")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("审查")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("意见")])]),a("td",{staticStyle:{height:"26vh",width:"570px"}},[a("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%",width:"100%","align-items":"flex-end","justify-content":"flex-end"}},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v("（单位盖章）")]),a("p",{staticStyle:{"margin-right":"20px"}},[a("span",{staticStyle:{"margin-right":"50px"}},[t._v("年")]),a("span",{staticStyle:{"margin-right":"50px"}},[t._v("月")]),a("span",[t._v("日")])])])])]),a("tr",{staticStyle:{"border-bottom":"1px solid #000"}},[a("th",{staticStyle:{height:"26vh",width:"120px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",border:"none",padding:"20px"}},[a("span",[t._v("主管")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("部门")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("审查")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("意见")])]),a("td",{staticStyle:{height:"26vh",width:"570px"}},[a("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%",width:"100%","align-items":"flex-end","justify-content":"flex-end"}},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v("（单位盖章）")]),a("p",{staticStyle:{"margin-right":"20px"}},[a("span",{staticStyle:{"margin-right":"50px"}},[t._v("年")]),a("span",{staticStyle:{"margin-right":"50px"}},[t._v("月")]),a("span",[t._v("日")])])])])]),a("tr",[a("th",{staticStyle:{height:"26vh",width:"120px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",border:"none",padding:"20px"}},[a("span",[t._v("批准")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("机关")]),a("span",{staticStyle:{"padding-top":"20px"}},[t._v("意见")])]),a("td",{staticStyle:{height:"26vh",width:"570px"}},[a("div",{staticStyle:{display:"flex","flex-direction":"column",height:"100%",width:"100%","align-items":"flex-end","justify-content":"flex-end"}},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v("（单位盖章）")]),a("p",{staticStyle:{"margin-right":"20px"}},[a("span",{staticStyle:{"margin-right":"50px"}},[t._v("年")]),a("span",{staticStyle:{"margin-right":"50px"}},[t._v("月")]),a("span",[t._v("日")])])])])])])]),a("div",{staticStyle:{flex:"1","text-align":"center","font-family":"SimSun",height:"100vh","font-weight":"800px"}},[a("div",{staticStyle:{"text-align":"left"}},[a("span",[t._v("单据编号："+t._s(t.printData.serialNumber))]),a("div",{staticStyle:{margin:"0px",width:"50px",float:"right"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t._f("creatQrCode")(t.printData.serialNumber)}})])]),a("h1",{staticStyle:{"font-weight":"800","font-size":"36px","margin-top":"10vh"}},[t._v("领导干部因私事出国（境）审批表")]),a("div",{staticStyle:{width:"50%",height:"60%",display:"flex","justify-content":"center","align-items":"center","font-size":"20px",margin:"0 auto","flex-direction":"column"}},[a("div",{staticStyle:{display:"flex","flex-direction":"row",height:"70px"}},[a("p",{staticStyle:{width:"100px"}},[a("b",[t._v("姓")]),a("span",{staticStyle:{"margin-left":"50px"}},[a("b",[t._v("名")])])]),a("p",{staticStyle:{width:"300px",height:"26px","border-bottom":"2px solid #000"}},[t._v(t._s(t.printData.fullName))])]),a("div",{staticStyle:{display:"flex","flex-direction":"row",height:"70px"}},[a("p",{staticStyle:{width:"100px"}},[a("b",[t._v("单")]),a("span",{staticStyle:{"margin-left":"50px"}},[a("b",[t._v("位")])])]),a("p",{staticStyle:{width:"300px",height:"26px","border-bottom":"2px solid #000"}},[t._v(t._s(t.printData.workUnit))])]),a("div",{staticStyle:{display:"flex","flex-direction":"row",height:"70px"}},[a("p",{staticStyle:{width:"100px"}},[a("b",[t._v("职")]),a("span",{staticStyle:{"margin-left":"50px"}},[a("b",[t._v("务")])])]),a("p",{staticStyle:{width:"300px",height:"26px","border-bottom":"2px solid #000"}},[t._v(t._s(t.printData.professionalPost))])]),a("div",{staticStyle:{display:"flex","flex-direction":"row",height:"70px"}},[a("p",{staticStyle:{width:"100px",position:"relative"}},[a("b",[t._v("前往")]),a("span",{staticStyle:{position:"relative",top:"-15px",left:"2px"}},[a("b",[t._v("国家")])]),a("span",{staticStyle:{position:"relative",top:"-10px",left:"22px"}},[a("b",[t._v("地区")])])]),a("p",{staticStyle:{width:"300px",height:"26px","border-bottom":"2px solid #000"}},[t._v(t._s(t.printData.destination))])])]),a("div",{staticStyle:{"font-size":"20px"}},[a("p",[a("b",[t._v("中共浙江省委组织部制")])]),a("p",[a("span",{staticStyle:{"margin-left":"30px"}},[a("b",[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("yearFitters")((new Date).getFullYear())))]),t._v("年 ")])]),a("span",{staticStyle:{"margin-left":"10px"}},[a("b",[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("dayFitters")((new Date).getMonth()+1)))]),t._v(" 月 ")])]),a("span",{staticStyle:{"margin-left":"10px"}},[a("b",[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("dayFitters")((new Date).getDate())))]),t._v(" 日填 ")])])])])])]),a("div",{staticStyle:{display:"flex",height:"95vh",width:"100%"}},[a("div",{staticStyle:{flex:"1","text-align":"center","margin-top":"5vh"}},[a("table",{staticStyle:{margin:"0 auto","border-collapse":"collapse",padding:"2px"},attrs:{border:"1"}},[a("tr",[a("th",{staticStyle:{width:"120px",height:"40px"}},[t._v("姓名")]),a("td",{staticStyle:{width:"120px",height:"40px"}},[t._v(t._s(t.printData.fullName))]),a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("性别")]),a("td",{staticStyle:{width:"90px",height:"40px"}},[t._v(t._s(t.printData.sex))]),a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("民族")]),a("td",{staticStyle:{width:"90px",height:"40px"}},[t._v(t._s(t.printData.nation))])]),a("tr",[a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("籍贯")]),a("td",{staticStyle:{width:"90px",height:"40px"}},[t._v(t._s(t.printData.nativePlace))]),a("th",{staticStyle:{width:"90px",height:"40px"},attrs:{colspan:"2"}},[t._v("出生年月日")]),a("td",{staticStyle:{width:"90px",height:"40px"},attrs:{colspan:"2"}},[t._v(t._s(t.printData.birthday))])]),a("tr",[a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("参加工作时间")]),a("td",{staticStyle:{width:"120px"}},[t._v(t._s(t.printData.workday))]),a("th",{staticStyle:{width:"90px",height:"40px"},attrs:{colspan:"2"}},[t._v("参加党团时间")]),a("td",{staticStyle:{width:"90px",height:"40px"},attrs:{colspan:"2"}},[t._v(t._s(t.printData.joinPartyDay))])]),a("tr",[a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("学历")]),a("td",{staticStyle:{width:"90px",height:"40px"}},[t._v(t._s(t.printData.education))]),a("th",{staticStyle:{width:"120px",height:"40px"}},[t._v("何时离(退)休")]),a("td",{staticStyle:{width:"120px",height:"40px"}},[t._v(t._s(t.printData.retirementTime))]),a("th",{staticStyle:{width:"90px",height:"40px"}},[t._v("健康状况")]),a("td",{staticStyle:{width:"90px",height:"40px"}},[t._v(t._s(t.printData.health))])]),a("tr",[a("th",{staticStyle:{height:"40px"}},[t._v("单位职务")]),a("td",{staticStyle:{height:"40px"},attrs:{colspan:"5"}},[t._v(t._s(t.printData.professionalPost))])]),a("tr",[a("th",{staticStyle:{height:"40px"}},[t._v("公民身份号码")]),a("td",{staticStyle:{height:"40px"},attrs:{colspan:"5"}},[t._v(t._s(t.printData.cardID))])]),a("tr",[a("th",{staticStyle:{width:"90px"},attrs:{rowspan:"2"}},[t._v("国外通讯处")]),a("th",{staticStyle:{height:"40px"}},[t._v("中文")]),a("td",{staticStyle:{height:"40px"},attrs:{colspan:"4"}},[t._v(t._s(t.printData.zhAddress))])]),a("tr",[a("th",{staticStyle:{height:"40px"}},[t._v("外文")]),a("td",{staticStyle:{height:"40px"},attrs:{colspan:"4"}},[t._v(t._s(t.printData.enAddress))])]),a("tr",[a("th",{staticStyle:{height:"270px",width:"120px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",border:"none",padding:"20px"}},[a("span",{staticStyle:{"margin-bottom":"100px"}},[t._v("简")]),a("span",[t._v("历")])]),a("td",{staticStyle:{height:"270px","text-align":"left",padding:"20px"},attrs:{colspan:"6"}},[t._v(t._s(t.printData.resume))])]),a("tr",[a("th",{staticStyle:{height:"270px",width:"120px",padding:"20px"}},[t._v("国内直系亲属及主要社会关系情况")]),a("td",{staticStyle:{height:"270px","text-align":"left",padding:"20px"},attrs:{colspan:"6"}},[t._v(t._s(t.printData.resume))])])])]),a("div",{staticStyle:{flex:"1","text-align":"center","margin-top":"5vh"}},[a("table",{staticStyle:{margin:"0 auto","border-collapse":"collapse",padding:"2px"},attrs:{border:"1"}},[a("tr",[a("th",{staticStyle:{height:"281px",padding:"20px",width:"90px"}},[t._v("国外直系亲属及主要社会关系情况")]),a("td",{staticStyle:{height:"281px",width:"570px","text-align":"left",padding:"20px"}},[t._v(t._s(t.printData.domesticRelatives))])]),a("tr",[a("th",{staticStyle:{height:"281px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",border:"none"}},[a("span",{staticStyle:{"margin-bottom":"20px"}},[t._v("政")]),a("span",{staticStyle:{"margin-bottom":"20px"}},[t._v("治")]),a("span",{staticStyle:{"margin-bottom":"20px"}},[t._v("表")]),a("span",{staticStyle:{"margin-bottom":"20px"}},[t._v("现")])]),a("td",{staticStyle:{height:"282px",width:"570px","text-align":"left",padding:"20px"}},[t._v(t._s(t.printData.political))])]),a("tr",[a("th",{staticStyle:{height:"281px",padding:"20px",width:"90px"}},[t._v("申请理由、目的地、时间、期限和费用自理情况")]),a("td",{staticStyle:{height:"281px",width:"570px","text-align":"left",padding:"20px"}},[a("div",[a("p",[t._v("申请理由："+t._s(t.printData.abroadReason))]),a("p",[t._v("拟出国（境）目的地："+t._s(t.printData.destination))]),a("p",[t._v("拟出国（境）时间："+t._s(t.printData.toAbroadTime))]),a("p",[t._v("拟在国（境）外停留时间："+t._s(t.printData.residenceTime))])])])])])])])]],2)},X=[],Z=a("35db"),tt={0:{value:"〇"},1:{value:"一"},2:{value:"二"},3:{value:"三"},4:{value:"四"},5:{value:"五"},6:{value:"六"},7:{value:"七"},8:{value:"八"},9:{value:"九"},10:{value:"十"}},et={filters:{creatQrCode:function(t){if(t){var e=2,a="L";k.a.stringToBytes=k.a.stringToBytesFuncs["UTF-8"];var i=k()(e,a);return i.addData(t,"Byte"),i.make(),i.createDataURL(2,0)}},yearFitters:function(t){if(t){var e=t.toString().split(""),a=Object.keys(tt),i="";return e.forEach((function(t){a.forEach((function(e){t==e&&(i+=tt[t].value)}))})),i}},dayFitters:function(t){if(t){var e=t.toString().split(""),a=Object.keys(tt),i="";if(e.length>1){"1"==e[0]&&(e[0]=tt["10"].value),"2"==e[0]&&(e[0]=tt["2"].value+tt["10"].value),"3"==e[0]&&(e[0]=tt["3"].value+tt["10"].value);var n=e[0];return a.forEach((function(t){"0"==e[1]||e[1]==t&&(i+=tt[t].value)})),n+i}return a.forEach((function(t){e[0]==t&&(i+=tt[t].value)})),i}}},props:{printData:{type:Object},getList:{type:Function},type:{type:String}},data:function(){return{list:{},professionalJob:[],loading:!1}},computed:{},created:function(){},mounted:function(){},watch:{},methods:{postPackagePrinting:function(){var t=this;this.loading=!0,document.title="审批表 - 报备审批和证件领用",Object(m["f"])({orderNo:this.printData.orderNo}).then((function(e){0==e.errorCode&&(t.loading=!1,t.$store.commit("_FIRSTPRINT",!0),t.getList())})).catch((function(){t.loading=!1}))}},components:{print:Z["a"]}},at=et,it=Object(C["a"])(at,G,X,!1,null,null,null),nt=it.exports,st=a("6250"),rt=[{title:"单据编号",width:200,align:"center",dataIndex:"orderNo"},{title:"姓名",width:100,align:"center",dataIndex:"allname",scopedSlots:{customRender:"allname"}},{title:"公民身份号码",dataIndex:"cardID",width:200,align:"center",scopedSlots:{customRender:"cardID"}},{title:"前往国家(地区)",dataIndex:"destination",width:100,align:"center"},{title:"出国(境)时间",dataIndex:"toAbroadTime",width:100,align:"center"},{title:"上次因私出国(境)时间",dataIndex:"lastTimeToAbroadTime",width:120,align:"center"},{title:"停留时间(天)",dataIndex:"residenceTime",width:100,align:"center"},{title:"同行人员",dataIndex:"accompanier",width:100,align:"center"},{title:"状态",dataIndex:"state",width:100,align:"center",scopedSlots:{customRender:"state"}},{title:"操作",dataIndex:"action",width:250,align:"center",scopedSlots:{customRender:"action"}}],ot=[],lt=[],ct={};function dt(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}var pt={components:{perosonModal:K,ApprovalNew:nt,ConsentLetterNew:P,approvManagementModal:W,help:st["a"]},data:function(){var t=this;return{metaTypeDetail:!1,router:{},conNo:"",orderNo:"",eleTitle:"出国(境)审批表采集",okText:"下一步",visiblePrint:!1,detailsStatusDialogVisible:!1,detailsForm:{},defaultValue:[],HKDefaultValue:["0"],TaiwanDefaultValue:[],ordinaryPassportShow:!1,HKShow:!1,HKEndorsementShow:!1,TaiwanShow:!1,TaiwanEndorsementShow:!1,passOptions:[{value:1,label:"首次申领"},{value:2,label:"补发"},{value:3,label:"换发"},{value:4,label:"失效重新申领"}],endorsementOptions:[{value:"1",label:"团队旅游",HKTimeOption:[{value:"1",label:"3个月一次"},{value:"2",label:"3个月二次"},{value:"4",label:"1年一次"},{value:"5",label:"1年二次"}],MacaoOption:[{value:"1",label:"3个月一次"},{value:"4",label:"1年一次"}]},{value:"2",label:"个人旅游",HKTimeOption:[{value:"1",label:"3个月一次"},{value:"2",label:"3个月二次"},{value:"4",label:"1年一次"},{value:"5",label:"1年二次"},{value:"6",label:"1年多次"}],MacaoOption:[{value:"1",label:"3个月一次"},{value:"4",label:"1年一次"}]},{value:"3",label:"商务",HKTimeOption:[{value:"1",label:"3个月一次"},{value:"3",label:"3个月多次"},{value:"6",label:"1年多次"}],MacaoOption:[{value:"1",label:"3个月一次"},{value:"3",label:"3个月多次"},{value:"6",label:"1年多次"}]},{value:"4",label:"探亲",HKTimeOption:[{value:"1",label:"3个月一次"},{value:"3",label:"3个月多次"},{value:"6",label:"1年多次"}],MacaoOption:[{value:"1",label:"3个月一次"},{value:"3",label:"3个月多次"},{value:"6",label:"1年多次"}]},{value:"5",label:"逗留",HKTimeOption:[{value:"7",label:"多次有效"}],MacaoOption:[{value:"7",label:"多次有效"}]},{value:"9",label:"其他",HKTimeOption:[{value:"1",label:"3个月一次"},{value:"2",label:"3个月二次"},{value:"3",label:"3个月多次"}],MacaoOption:[{value:"1",label:"3个月一次"},{value:"2",label:"3个月二次"},{value:"3",label:"3个月多次"}]}],KEndorsementIndex:"1",TaiwanEndorsementOptions:[{value:"1",label:"团队旅游"},{value:"2",label:"个人旅游"},{value:"3",label:"商务"},{value:"4",label:"探亲"},{value:"5",label:"应邀"},{value:"6",label:"定居"},{value:"7",label:"学习"},{value:"8",label:"乘务"},{value:"9",label:"其他"}],TaiwanTimeShow:!0,certificateData:[],disabled:!1,disabledCheckOne:!1,disabledCheckTwo:!1,disabledCheckThird:!1,optionDisable:!1,passDisabled:!1,isShowEndor:!0,jobList:[],form:{},detailsLoading:!1,consentLetterStateList:Object(r["a"])({},J["a"]),detailSteps:"0",current:0,formRules:{surname:[{required:!0,message:"请填写姓",trigger:"blur"}],name:[{required:!0,message:"请填写名",trigger:"blur"}],cardID:[{required:!0,message:"请填写公民身份号码",trigger:"blur"}],myPhone:[{required:!0,message:"请填写手机号",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}],workUnit:[{required:!0,message:"请填写工作单位",trigger:"blur"}],professionalPost:[{required:!0,message:"请输入单位职务",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入人事部门联系人",trigger:"blur"},j["e"]],contactPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"},j["a"]],applicationType:[{required:!0,message:"请选择办理类型",trigger:"change"}],certificate:[{type:"array",required:!0,message:"请选择办理证件",trigger:"blur"}]},selectValue:"",pickerValue:void 0,statevalue:void 0,searchState:"",dateString:[],statelist:{ADD:{value:"1",text:"新增",color:"gold"},PRINTED:{value:"4",text:"已打印",color:"gold"},SUBMITTED:{value:"6",text:"已提交",color:"gold"},SUCCESSFUL_FILING:{value:"8",text:"备案成功",color:"green"}},direction:"1",visible:!1,modalForm:{},modalTitle:"",showtowmodal:!1,errorModal:!1,errorForm:{userinfo:{},errorInfo:"",type:""},plainOptions:[{label:"普通护照",value:"1"},{label:"往来港澳通行证及签注",value:"2"},{label:"往来台湾通行证及签注",value:"3"}],columns:rt,dataSource:ot,pagination:{current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showTotal:function(e){return"共 ".concat(e," 条记录 第").concat(t.pagination.current,"/").concat(Math.ceil(e/t.pagination.pageSize),"页")},onChange:function(e,a){t.pagination.current=e,t.getListNew()},onShowSizeChange:function(e,a){t.pagination.current=e,t.pagination.pageSize=a,t.getListNew()}},rules:{nation:[{required:!0,trigger:"change",message:"请输入民族",whitespace:!0},j["e"]],nativePlace:[{required:!0,trigger:"change",message:"请输入籍贯",whitespace:!0},j["e"]],education:[{required:!0,trigger:"change",message:"请选择学历"}],health:[{required:!0,trigger:"change",message:"请选择健康状态"}],retirementTime:[{required:!0,trigger:"change",message:"请选择退休日期"}],workday:[{required:!0,trigger:"change",message:"请选择工作时间"}],attorneys:[{required:!0,trigger:"blur",message:"请输入代办人姓名",whitespace:!0},j["e"]],attorneysPhone:[{required:!0,trigger:"blur",message:"请输入代办人手机号",whitespace:!0},j["h"]],destination:[{required:!0,trigger:"blur",message:"请输入出国（境）目的地",whitespace:!0},j["e"]],toAbroadTime:[{required:!0,trigger:"change",message:"请选择出国（境）时间"}],residenceTime:[{required:!0,trigger:"change",message:"请选择停留时间"},j["f"]],accompanier:[{required:!0,trigger:"blur",message:"请输入同行人员",whitespace:!0},j["e"]],abroadReason:[{required:!0,trigger:"blur",message:"请输入申请出国（境）事由",whitespace:!0}],selfCare:[{required:!0,trigger:"blur",message:"请输入费用自理情况",whitespace:!0}],resume:[{required:!0,trigger:"blur",message:"请输入工作简历",whitespace:!0}],domesticRelatives:[{required:!0,trigger:"blur",message:"请输入国内直系亲属及主要社会关系情况",whitespace:!0}],abroadRelatives:[{required:!0,trigger:"blur",message:"请输入国外直系亲属及主要社会关系情况",whitespace:!0}],political:[{required:!0,trigger:"blur",message:"请输入政治情况",whitespace:!0}],zhAddress:[{required:!0,trigger:"blur",message:"请输入中文地址",whitespace:!0}],enAddress:[{required:!0,trigger:"blur",message:"请输入英文地址",whitespace:!0},j["i"]]},nowrecord:{},noworderno:"",professionalList:[],PoliticalOutlookList:[],educationList:[],isadd:!1,isjoinParty:!0,printData:{},excelData:{},uploading:!1,errorDetailsDialogVisible:!1,errorTableColumnList:[{title:"公民身份号码",dataIndex:"cardID",align:"center",width:"200px",scopedSlots:{customRender:"cardID"}},{title:"错误信息",dataIndex:"unSuccessInfo",width:"200px",align:"center"}],errorTableDataList:[],excelColumns:[{header:"人员公民身份号码码（必填）",key:"cardID",width:20,style:{numFmt:"@"}},{header:"籍贯（必填）",key:"nativePlace",width:20,style:{numFmt:null}},{header:"民族（必填）",key:"nation",width:20},{header:"健康状态（必填）",key:"health",width:20},{header:"工作日期（必填）",key:"workday",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"入党日期",key:"joinPartyDay",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"学历（必填）",key:"education",width:20,style:{numFmt:null}},{header:"退休日期（必填）",key:"retirementTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"代办人（必填）",key:"attorneys",width:20,style:{numFmt:null}},{header:"代办人手机号（必填）",key:"attorneysPhone",width:20},{header:"出国事由（必填）",key:"abroadReason",width:20},{header:"前往国家，目的地（必填）",key:"destination",width:20},{header:"出国时间（必填）",key:"toAbroadTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"停留时间(天)（必填）",key:"residenceTime",width:20,style:{numFmt:null}},{header:"同行人员（必填）",key:"accompanier",width:20},{header:"上次因私出国地点（必填）",key:"lastTimeToAbroad",width:20},{header:"上次因私出国时间（必填）",key:"lastTimeToAbroadTime",width:20,style:{numFmt:"yyyy/mm/dd"}},{header:"领用证件（必填）",key:"credentials",width:20,style:{numFmt:null}},{header:"中文通讯地址（必填）",key:"zhAddress",width:20},{header:"英文通讯地址（必填）",key:"enAddress",width:20},{header:"费用自理情况（必填）",key:"selfCare",width:40},{header:"工作简历（必填）",key:"resume",width:40},{header:"国内直系亲属及主要社会关系情况（必填）",key:"domesticRelatives",width:40},{header:"国外直系亲属及主要社会关系情况（必填）",key:"abroadRelatives",width:40},{header:"政治表现（必填）",key:"political",width:40},{header:"备注信息",key:"attach",width:20}],isloading:!1,imageUrl:"",electronic:{},statusDialogVisible:!1,loading:!1,stepStateList:Q["a"],stepCurrent:"0",alive:!0}},computed:{},beforeRouteEnter:function(t,e,a){t.path!==e.path?a((function(e){t.query.current?e.current=Number(t.query.current):e.current=0,e.$store.commit("_FIRSTPRINT",!1),e.selectValue="",e.statevalue=void 0,e.pickerValue=void 0,e.alive=!1,e.searchState="",e.router=t,e.$nextTick((function(){e.alive=!0,e.getListNew()}))})):a()},created:function(){var t=this;this.getDictionaryEducation(),Object(I["c"])().then((function(e){t.professionalList=e.data.list,lt=e.data.list;var a=e.data;if(t.jobList=a.list&&a.list.length?a.list:[],ct={},a.list&&a.list.length)for(var i=0;i<a.list.length;i++){var n=a.list[i];ct[n.value]={text:n.label}}})),Object(I["b"])().then((function(e){t.PoliticalOutlookList=e.data.list}))},filters:{stateFilter:function(t){return Object.values(J["a"]).find((function(e){return e.value===t})).text},statebageFilter:function(t){return Object.values(J["a"]).find((function(e){return e.value===t})).color},professFilter:function(t){if(t)return Object.values(lt).find((function(e){return e.value===t})).label},stepStateFilter:function(t){try{var e=Object.values(Q["a"]).find((function(e){return e.values.some((function(e){return e===t}))})).current;return e||0}catch(a){return 0}},professionalPostFilter:function(t){return t?ct[t].text:""},passOptions:function(t){return t?T[t].label:T["1"].label},certificateType:function(t){var e={1:{label:"普通护照"},2:{label:"往来港澳通行证和签注"},3:{label:"往来台湾通行证和签注"}};return t?e[t].label:"请选择"},endorsementOptions:function(t){var e={1:{label:"团队旅游"},2:{label:"个人旅游"},3:{label:"商务"},4:{label:"探亲"},5:{label:"逗留"},6:{label:"其他"}};return t?e[t].label:"请选择"},TaiwanEndorsementOptions:function(t){var e={1:{label:"团队旅游"},2:{label:"个人旅游"},3:{label:"商务"},4:{label:"探亲"},5:{label:"应邀"},6:{label:"定居"},7:{label:"学习"},8:{label:"乘务"},9:{label:"其他"}};return t?e[t].label:"请选择"},timeOptions:function(t){var e={1:{label:"3个月一次"},2:{label:"3个月二次"},3:{label:"3个月多次"},4:{label:"1年一次"},5:{label:"1年二次"},6:{label:"1年多次"},7:{label:"多次有效"},8:{label:"6个月一次"}};return t?e[t].label:"请选择"},cardIDShade:o["a"]},mounted:function(){this.isloading=!1},methods:{cancelSpb:function(){this.current=1},printRow:function(t){"4"==this.router.meta.type?(this.modalForm.isDetail=!0,this.print(t)):(this.$store.commit("_FIRSTPRINT",!1),this.orderNo=t.orderNo,this.conNo=t.contentOrderNo,this.modalForm=t,this.detailsForm=t,this.visiblePrint=!0)},rePrint:function(){"4"!=this.router.meta.type?(this.visiblePrint=!0,this.visible=!1):this.print(this.nowrecord)},getDictionaryEducation:function(){var t=this;Object(I["a"])().then((function(e){var a=e.data;t.educationList=a.list&&a.list.length?a.list:[]}))},changeAbroad:function(t,e){this.modalForm.toAbroadTime=e},disabledDate:function(t){return t&&t>p()().endOf("day")},disabledDateafter:function(t){return t&&t<p()().endOf("day")},reset:function(t){this.selectValue="",this.statevalue=void 0,this.pickerValue=void 0,this.searchClick(t)},searchClick:function(t){this.pagination.current=1;var e=this.$store.state.app.firstPrint;"4"==this.router.meta.type?"reset"==t?(this.current=0,this.changeSteps(0)):e?(this.current=2,this.changeSteps(2)):(this.current=0,this.changeSteps(0)):1==t||8==t||""==t?this.changeSteps(0):4==t?this.changeSteps(1):6==t?this.changeSteps(2):this.changeSteps(0)},searchClick1:function(){this.pagination.current=1,this.visiblePrint=!1,this.current=2,this.changeSteps(2)},add:function(){this.detailSteps="0",this.ordinaryPassportShow=!1,this.HKShow=!1,this.TaiwanShow=!1,this.$refs.modalForm&&this.$refs.modalForm.resetFields(),this.modalForm={},this.modalForm.state="1",this.modalTitle="出国（境）审批表",this.visible=!0,this.nowrecord={state:"1"},this.isadd=!0,this.optionDisable=!1,this.isjoinParty=!0},showmodal:function(t){this.optionDisable=!0,"4"==this.router.meta.type?this.metaTypeDetail=!0:this.metaTypeDetail=!1,this.$refs.modalForm&&this.$refs.modalForm.resetFields();var e=new Date;Object(o["j"])(e);this.orderNo=t.contentOrderNo,this.nowrecord=Object(r["a"])({},t),this.conNo=t.contentOrderNo,this.nowrecord.fullName=t.surname+t.name,this.modalForm=Object(r["a"])({},t),this.modalForm.fullName=t.surname+t.name,this.printData=this.modalForm,this.modalForm.state===this.statelist["ADD"].value&&this.choosedisabled(t),this.modalTitle="出国（境）审批表详细信息",this.visible=!0,this.isadd=!1,this.isjoinParty=!0,this.disabled=!0},choosedisabled:function(t){"0"!==t.passport&&(this.plainOptions.find((function(t){return"1"==t.value})).disabled=!1),"0"!==t.exitEntryPermitForHKMacao&&(this.plainOptions.find((function(t){return"2"==t.value})).disabled=!1,this.plainOptions.find((function(t){return"3"==t.value})).disabled=!1),this.plainOptions=Object(s["a"])(this.plainOptions)},postForm:function(){var t=this;this.modalForm.surname=this.modalForm.surname.split("",1)[0],this.modalForm.processingType=this.$route.meta.type,this.$refs.modalForm.validate((function(e){if(!e)return t.isloading=!1,!1;t.isloading=!0;var a=Object(r["a"])({},t.modalForm);if(!a.name)return t.isloading=!1,void t.$message.error("请选择出国人员");a.workday=p()(t.modalForm.workday).startOf("day").valueOf().toString(),a.joinPartyDay=a.joinPartyDay?p()(t.modalForm.joinPartyDay).startOf("day").valueOf().toString():"",a.toAbroadTime=p()(t.modalForm.toAbroadTime).startOf("day").valueOf().toString(),a.retirementTime=p()(t.modalForm.retirementTime).startOf("day").valueOf().toString(),a.lastTimeToAbroadTime=p()(t.modalForm.lastTimeToAbroadTime).startOf("day").valueOf().toString(),t.isadd?Object(m["e"])(Object(r["a"])(Object(r["a"])({},a),{},{processingType:a.processingType.toString()})).then((function(e){0==e.errorCode&&(t.$message.success("保存成功"),t.visible=!1,t.nowrecord={},t.orderNo=e.data.orderNo,"4"!=t.router.meta.type?t.detailsStatusDialogVisible=!0:(t.modalForm.isDetail=!1,t.print(t.modalForm)))})).catch((function(){t.isloading=!1})).finally((function(){t.isloading=!1})):Object(m["i"])(Object(r["a"])({},a)).then((function(e){t.$message.success("保存成功"),t.isloading=!1,t.visible=!1,t.nowrecord={}})).catch((function(){t.isloading=!1})).finally((function(){t.isloading=!1}))}))},putapplicationForm:function(){var t=this;this.modalForm.surname=this.modalForm.surname.split("",1)[0],this.$refs.modalForm.validate((function(e){if(!e)return t.isloading=!1,!1;t.isloading=!0;var a=Object(r["a"])({},t.modalForm);if(!a.name)return t.isloading=!1,void t.$message.error("请选择出国人员");a.workday=p()(t.modalForm.workday).startOf("day").valueOf().toString(),a.joinPartyDay=a.joinPartyDay?p()(t.modalForm.joinPartyDay).startOf("day").valueOf().toString():"",a.toAbroadTime=p()(t.modalForm.toAbroadTime).startOf("day").valueOf().toString(),a.retirementTime=p()(t.modalForm.retirementTime).startOf("day").valueOf().toString(),a.lastTimeToAbroadTime=p()(t.modalForm.lastTimeToAbroadTime).startOf("day").valueOf().toString(),Object(m["i"])(Object(r["a"])({},a)).then((function(e){t.$message.success("修改成功"),t.isloading=!1,t.visible=!1,t.nowrecord={},t.searchClick()})).catch((function(){t.isloading=!1})).finally((function(){t.isloading=!1}))}))},deleteForm:function(){var t=this;this.isloading=!0,Object(m["b"])({orderNo:this.modalForm.orderNo}).then((function(e){0==e.errorCode&&(t.isloading=!1,t.nowrecord={},t.visible=!1,"4"!=t.router.meta.type?t.deleteCon():(t.$message.success("作废成功！"),t.searchClick1(),t.metaTypeDetail=!1))})).catch((function(){t.isloading=!1}))},showpersonModal:function(){this.showtowmodal=!0,this.modalForm.credentials=void 0},handleOk:function(t){this.choosedisabled(t);var e=new Date;Object(o["j"])(e);delete t.retirementTime,delete t.nation,delete t.nativePlace,delete t.education,delete t.workday,delete t.health,delete t.joinPartyDay,t.fullName=t.surname+t.name,this.modalForm=Object(r["a"])(Object(r["a"])({},this.modalForm),t),this.modalForm.personID=this.modalForm.id.toString(),this.modalForm.state=this.nowrecord.state,this.modalForm.myPhone=t.mobilePhone,this.modalForm.politicalOutlook&&"12"!=this.modalForm.politicalOutlook&&"13"!=this.modalForm.politicalOutlook?this.isjoinParty=!1:(this.isjoinParty=!0,this.modalForm.joinPartyDay=void 0),this.showtowmodal=!1},cancel:function(){this.showtowmodal=!1},cancel1:function(){this.errorModal=!1,this.uploading=!1},cancelApprov:function(){this.visible=!1},print:function(t){var e=this;this.visible=!1,0==Object.keys(this.nowrecord).length?this.printData=Object(r["a"])({},t):this.printData=Object(r["a"])({},this.nowrecord),this.nowrecord={},this.printData.orderNo||(this.printData.orderNo=this.orderNo),this.printData.fullName=this.printData.surname+this.printData.name,this.printData.serialNumber="C"+this.orderNo,this.printData.professionalPost&&(this.printData.professionalPost=Object.values(this.professionalList).find((function(t){return t.value===e.printData.professionalPost})).label),this.printData.education&&(this.printData.education=Object.values(this.educationList).find((function(t){return t.value===e.printData.education})).label),this.printData.politicalOutlook&&(this.printData.politicalOutlook=Object.values(this.PoliticalOutlookList).find((function(t){return t.value===e.printData.politicalOutlook})).label),this.setRow(t),sessionStorage.setItem("printData",JSON.stringify(this.printData)),this.$store.commit("SET_PRINTSHOW",!0),this.stepCurrent=2,this.getListNew()},closemodal:function(){this.visible=!1,this.metaTypeDetail=!1,this.nowrecord={}},setRow:function(t){var e=this;return{on:{click:function(a){e.noworderno=t.orderNo,e.stepCurrent=t.state}}}},getElectronicList:function(t){var e=this;"4"==this.router.meta.type?this.okText="数据上报":this.okText="下一步",this.eleTitle="出国(境)审批表采集",this.visible=!1,this.electronic=Object(r["a"])(Object(r["a"])({},t),{},{serialNumber:"C"+t.orderNo,serialNumber1:"T"+this.conNo}),this.orderNo=t.contentOrderNo,Object(m["c"])({orderNo:this.electronic.orderNo}).then((function(t){0==t.errorCode&&(e.electronic.imageUrl=t.data.image&&e.electronic.state>J["a"].PRINTED.value?e.$store.state.app.picturePrefixAddress+t.data.image:"",e.electronic=Object(r["a"])({},e.electronic))})),this.statusDialogVisible=!0},getConsentElectronicInfo:function(){var t=this,e={orderNo:this.electronic.orderNo};h(e).then((function(e){var a=e.data;t.electronic=Object(r["a"])(Object(r["a"])({},a),t.electronic),t.electronic.image=t.electronic.image&&t.electronic.state!==J["a"].PRINTED.value?t.$store.state.app.picturePrefixAddress+t.electronic.image:""}))},handleCancel:function(){this.statusDialogVisible=!1},changeSteps:function(t){this.current=t,0==t?(this.searchState="",this.modalForm.state=this.statelist["ADD"].value,this.optionDisable=!0,this.getListNew()):1==t?(this.searchState="1,2",this.modalForm.state=this.statelist["PRINTED"].value,this.optionDisable=!0,this.getListNew()):2==t?(this.searchState="4,5",this.optionDisable=!0,this.modalForm.state=this.statelist["SUBMITTED"].value,this.getListNew()):(this.searchState="",this.getListNew(),this.optionDisable=!1)},getListNew:function(){var t=this,e={pageNo:this.pagination.current+"",pageSize:this.pagination.pageSize.toString(),selectValue:this.selectValue,beginTime:this.dateString[0],endTime:this.dateString[1],direction:this.direction.toString(),state:this.searchState,processingType:this.$route.meta.type};Object(m["d"])(e).then((function(e){if(0==e.errorCode){t.pagination.total=Number(e.data.total),t.dataSource=e.data.data?e.data.data:[];var a=t.dataSource.findIndex((function(e){return e.orderNo==t.noworderno}));t.noworderno=-1!==a?t.dataSource[a].orderNo:"",t.stepCurrent=-1!==a?t.dataSource[a].state:""}else t.dataSource=[]}))},printOK:function(){document.title=this.$route.meta.title+" - 报备审批和证件领用",this.visiblePrint=!1,this.current=1,this.searchState="1,2",this.getListNew()},nextConsentLetter:function(){var t=this;this.$refs.modalForm.validate((function(e){if(e){if(t.modalForm.fullName=t.modalForm.surname+t.modalForm.name,t.detailsForm=t.modalForm,!t.detailsForm.credentials)return void t.$message.error("请选择证件类型");switch(t.passDisabled=!0,t.$route.meta.type){case"1":t.form.passOption="1",t.form.hkOption="1",t.form.taiwanOption="1",t.isShowEndor=!0;break;case"2":t.form.hkOption="5",t.form.taiwanOption="5",t.form.passDisabled=!0,t.isShowEndor=!0;break;case"3":t.form.passOption="3",t.form.hkOption="3",t.form.taiwanOption="3",t.isShowEndor=!0;default:break}if(t.isadd){if(t.modalForm.processingType=t.$route.meta.type,"1"==t.modalForm.processingType.toString())switch(t.modalForm.credentials){case"1":if("0"!==t.modalForm.passport)return t.$message.error("已有该证件"),void(t.isloading=!1);break;case"2":if("0"!==t.modalForm.exitEntryPermitForHKMacao)return t.$message.error("已有该证件"),void(t.isloading=!1);break;case"3":if("0"!==t.modalForm.exitEntryPermitForTW)return t.$message.error("已有该证件"),void(t.isloading=!1);break;default:break}else switch(t.modalForm.credentials){case"1":if("1"==t.modalForm.passport)return t.$message.error("该人员护照尚未入库，请先入库！"),void(t.isloading=!1);break;case"2":if("0"==t.modalForm.exitEntryPermitForHKMacao)return t.$message.error("请前往新证办理相应证件"),void(t.isloading=!1);if("1"==t.modalForm.exitEntryPermitForHKMacao)return t.$message.error("该人员护港澳通行证及签注未入库，请先入库！"),void(t.isloading=!1);break;case"3":if("0"==t.modalForm.exitEntryPermitForTW)return t.$message.error("请前往新证办理相应证件"),void(t.isloading=!1);if("1"==t.modalForm.exitEntryPermitForTW)return t.$message.error("该人员护台湾通行证及签注未入库，请先入库！"),void(t.isloading=!1);break;default:break}t.postForm(),"1"==t.detailsForm.credentials?(t.defaultValue.push("0"),t.ordinaryPassportShow=!0,t.HKShow=!1,t.TaiwanShow=!1,t.detailsForm.passHas="1",t.certificateData.push({certificateType:1,passHas:1,passOption:t.form.passOption,hkHas:0,hkOption:"",hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanHas:"",taiwanOption:"",taiwanType:"",taiwanEndorsementTime:""})):"2"==t.detailsForm.credentials?(t.defaultValue.push("1"),t.ordinaryPassportShow=!1,t.HKShow=!0,t.TaiwanShow=!1,t.detailsForm.hkHas="1",t.HKDefaultValue.push("0"),t.certificateData.push({certificateType:2,hkHas:1,passHas:"",passOption:"",hkOption:t.form.hkOption,hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanHas:"",taiwanOption:"",taiwanType:"",taiwanEndorsementTime:""})):"3"==t.detailsForm.credentials&&(t.defaultValue.push("2"),t.ordinaryPassportShow=!1,t.HKShow=!1,t.TaiwanShow=!0,t.detailsForm.taiwanHas="1",t.TaiwanDefaultValue.push("0"),t.certificateData.push({certificateType:3,taiwanHas:1,hkHas:"",passHas:"",passOption:"",hkOption:"",hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanOption:t.form.taiwanOption,taiwanType:"",taiwanEndorsementTime:""}))}else 0==t.current&&(t.disabled=!0,t.optionDisable=!0),"4"!=t.router.meta.type&&w({orderNo:t.orderNo}).then((function(e){0==e.errorCode&&(t.detailsStatusDialogVisible=!0,e.data?(t.form=Object(r["a"])(Object(r["a"])({},t.form),e.data),e.data.fullName=e.data.surname+e.data.name,t.detailsForm=Object(r["a"])(Object(r["a"])({},t.detailsForm),e.data),"1"==t.detailsForm.passHas&&(t.defaultValue.push("0"),t.ordinaryPassportShow=!0,t.certificateData.push(Object(r["a"])({certificateType:1,passHas:1,passOption:t.form.passOption,hkHas:0,hkOption:"",hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanHas:"",taiwanOption:"",taiwanType:"",taiwanEndorsementTime:""},e.data))),"1"==t.detailsForm.hkHas&&(t.defaultValue.push("1"),t.HKShow=!0,t.form.HMCategory=e.data.hkTime?"1":e.data.macaoTime?"2":void 0,t.certificateData.push(Object(r["a"])({certificateType:2,hkHas:1,passHas:"",passOption:"",hkOption:t.form.hkOption,hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanHas:"",taiwanOption:"",taiwanType:"",taiwanEndorsementTime:""},e.data)),""!=t.detailsForm.hkOption&&(t.HKEndorsementShow=!0,t.HKDefaultValue.push("0"))),"1"==t.detailsForm.taiwanHas&&(t.defaultValue.push("2"),t.TaiwanShow=!0,t.certificateData.push(Object(r["a"])({certificateType:3,taiwanHas:1,hkHas:"",passHas:"",passOption:"",hkOption:"",hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanOption:t.form.taiwanOption,taiwanType:"",taiwanEndorsementTime:""},e.data)),""!=t.TaiwanEndorsementOptions&&(t.TaiwanEndorsementShow=!0,t.TaiwanDefaultValue.push("0")))):t.detailsForm={})}))}else t.$message.error("请填写表单信息")}))},showModalClick:function(t){this.detailsForm=t.state?Object(r["a"])({},t):{state:""},this.form=Object(r["a"])({},t),1==t.passHas&&(this.defaultValue.push("0"),this.ordinaryPassportShow=!0),1==t.hkHas&&(this.defaultValue.push("1"),this.HKShow=!0,null!=t.hkType&&(this.HKDefaultValue.push("0"),this.HKEndorsementShow=!0)),1==t.taiwanHas&&(this.defaultValue.push("2"),this.TaiwanShow=!0,this.certificateData.push({certificateType:3,taiwanHas:1,hkHas:"",passHas:"",passOption:"",hkOption:"",hkIsEndorsement:"",hkType:"",hkTime:"",macaoTime:"",taiwanOption:"",taiwanType:"",taiwanEndorsementTime:""}),null!=t.taiwanType&&(this.TaiwanDefaultValue.push("0"),this.TaiwanEndorsementShow=!0)),this.disabled=!0,this.detailsStatusDialogVisible=!0},certificateCheckboxChange:function(t){},handleChangeOrdinaryPassport:function(t){},handleChangeHK:function(t){},handleChangeTaiwan:function(t){},handleChangeEndorsement:function(t){this.HKDefaultValue=t,t.some((function(t){return""!=t}))?this.HKEndorsementShow=!0:this.HKEndorsementShow=!1,this.certificateData.forEach((function(t){"2"==t.certificateType&&(t.isEndorsement=!0)}))},handleChangeHKEndorsement:function(t){this.KEndorsementIndex=t,this.form.hkTime=void 0,this.form.macaoTime=void 0,this.certificateData.forEach((function(e){"2"==e.certificateType&&(e.hkType=t)}))},HMCategoryChange:function(){this.form.hkTime=void 0,this.form.macaoTime=void 0,this.form=Object(r["a"])({},this.form)},handleChangeHKTime:function(t){this.certificateData.forEach((function(e){"2"==e.certificateType&&(e.hkTime=t)}))},handleChangeMacaoTime:function(t){this.certificateData.forEach((function(e){"2"==e.certificateType&&(e.macaoTime=t)}))},handleChangeTaiwanEndorsement:function(t){this.TaiwanDefaultValue=t,t.some((function(t){return""!=t}))?this.TaiwanEndorsementShow=!0:this.TaiwanEndorsementShow=!1,this.certificateData.forEach((function(t){"3"==t.certificateType&&(t.isEndorsement=!0)}))},handleChangeTaiwanOption:function(t){this.TaiwanTimeShow=0==t||2==t||3==t||4==t,this.certificateData.forEach((function(e){"3"==e.certificateType&&(e.taiwanType=t)}))},handleChangeTaiwanTime:function(t){this.certificateData.forEach((function(e){"3"==e.certificateType&&(e.taiwanEndorsementTime=t)}))},saveClick:function(t){var e=this;this.detailsForm=Object(r["a"])(Object(r["a"])({},this.detailsForm),{},{taiwanHas:this.detailsForm?this.detailsForm.taiwanHas:"0",hkHas:this.detailsForm?this.detailsForm.hkHas:"0",passHas:this.detailsForm?this.detailsForm.passHas:"0",passOption:this.certificateData[0].passOption?this.certificateData[0].passOption.toString():"",hkOption:this.certificateData[0].hkOption?this.certificateData[0].hkOption.toString():"",hkType:this.certificateData[0].hkType?this.certificateData[0].hkType.toString():"",hkTime:this.certificateData[0].hkTime?this.certificateData[0].hkTime.toString():"",macaoTime:this.certificateData[0].macaoTime?this.certificateData[0].macaoTime.toString():"",taiwanOption:this.certificateData[0].taiwanOption?this.certificateData[0].taiwanOption.toString():"",taiwanType:this.certificateData[0].taiwanType?this.certificateData[0].taiwanType.toString():"",taiwanEndorsementTime:this.certificateData[0].taiwanEndorsementTime?this.certificateData[0].taiwanEndorsementTime.toString():""}),this.detailsForm.surname=this.modalForm.surname.split("",1)[0],this.detailsForm.applicationOrderNo=this.orderNo,this.detailsLoading=!0,this.$refs.ruleForm.validate((function(a){if(!a)return e.detailsLoading=!1,!1;t?e.putConsentRecordInfo():e.postConsentRecordInfo()}))},postConsentRecordInfo:function(){var t=this,e=Object(r["a"])({},this.detailsForm);f(e).then((function(e){0==e.errorCode&&(t.conNo=e.data.id,t.searchClick(),t.detailsStatusDialogVisible=!1,t.$message.success("新增成功"),t.visiblePrint=!0,t.certificateData=[],t.resetConsentLetterForm())})).catch((function(){t.detailsLoading=!1,t.visible=!1})).finally((function(){t.detailsLoading=!1,t.visible=!1}))},deleteCon:function(){this.detailsLoading=!0,this.deleteConsentRecordInfo()},deleteConsentRecordInfo:function(){var t=this;if(this.modalForm.contentOrderNo){var e={orderNo:this.modalForm.contentOrderNo};x(e).then((function(e){0==e.errorCode&&(t.detailsStatusDialogVisible=!1,t.$message.success("作废成功"),t.detailsForm={},t.searchClick(),t.resetConsentLetterForm())})).finally((function(){t.detailsLoading=!1}))}},putConsentRecordInfo:function(){var t=this,e=Object(r["a"])({},this.detailsForm);g(e).then((function(e){0==e.errorCode&&(t.detailsStatusDialogVisible=!1,t.$message.success("修改成功"),t.detailsForm={},t.certificateData=[],t.searchClick(),t.resetConsentLetterForm())})).catch((function(){t.detailsLoading=!1,t.visible=!1})).finally((function(){t.detailsLoading=!1,t.visible=!1}))},printClick:function(t){var e=this,a=this.$store.state.app.firstPrint;if(a){var i=t.orderNo?Object(r["a"])({},t):Object(r["a"])({},this.detailsForm);w({orderNo:this.conNo}).then((function(t){0==t.errorCode&&(Object.assign(i,t.data),e.printData=Object(r["a"])(Object(r["a"])(Object(r["a"])({},e.$store.state.app.unitInfo),i),{},{professionalPost:ct[t.data.professionalPost].text,serialNumber1:"T"+e.conNo}),e.detailsStatusDialogVisible=!1,e.$store.commit("SET_PRINTSHOWNEW",!0))}))}else this.$message.error("请先打印出入境审批表")},nextPrint:function(){this.saveClick(!1)},resetConsentLetterForm:function(){this.detailsStatusDialogVisible=!1,this.disabled=!1,this.defaultValue=[],this.HKDefaultValue=[],this.TaiwanDefaultValue=[],this.ordinaryPassportShow=!1,this.HKEndorsementShow=!1,this.TaiwanEndorsementShow=!1,this.HKShow=!1,this.TaiwanShow=!1,this.loading=!1,this.detailsLoading=!1,this.form={},this.detailsForm={},this.certificateData=[]},handleClose:function(){var t=this;this.resetConsentLetterForm(),this.isadd&&Object(m["b"])({orderNo:this.orderNo}).then((function(e){0==e.errorCode&&(t.$message.success("取消新增审批表"),t.searchClick())}))},elehandleOk:function(){var t=this;if(!this.electronic.imageUrl)return this.$message.warning("请选择文件");var e="";this.electronic.imageUrl.includes("data:application/pdf")?"出国(境)审批表采集"==this.eleTitle?(e=this.electronic.imageUrl.replace(/^data:application\/pdf;base64,/,""),Object(m["j"])({orderNo:this.electronic.orderNo,image:e}).then((function(e){0==e.errorCode&&(t.submitreport(),t.electronic.imageUrl="")}))):(e=this.electronic.imageUrl.replace(/^data:application\/pdf;base64,/,""),b({orderNo:this.orderNo,image:e}).then((function(e){t.postConsentSubmitList(),t.eleTitle="出国(境)审批表采集",t.okText="下一步"}))):this.submitreport()},handleChange:function(t){var e=this;this.isload=!0,"uploading"===t.file.status&&(this.electronic.imageUrl="",this.loading=!0,dt(t.file.originFileObj,(function(t){e.electronic.imageUrl=t,e.loading=!1}))),"done"===t.file.status&&dt(t.file.originFileObj,(function(t){e.electronic.imageUrl=t,e.loading=!1}))},elelbeforeUpload:function(t){var e="application/pdf"===t.type;return e||this.$message.error("你只能上传PDF文件!"),e},submitreport:function(){var t=this;Object(m["h"])({orderNo:[this.electronic.orderNo]}).then((function(e){0==e.errorCode&&("4"!=t.router.meta.type?(t.eleTitle="同意函档案采集",t.okText="数据提交"):(t.statusDialogVisible=!1,t.searchClick()),t.$message.success("提交成功"))}))},postConsentSubmitList:function(){var t=this,e={orderNo:[this.orderNo]};y(e).then((function(e){0==e.errorCode&&(t.$message.success("提交成功"),t.searchClick(),t.statusDialogVisible=!1)}))},handleSuccess:function(){var t=this,e=this.excelData,a=e.results;e.header;if(0===a.length)return this.uploading=!1,this.$message.warning("请选择有数据的excel");a.forEach((function(t){t.processingType="4",t.state="1"}));var i=a[0];this.isadd=!0,this.modalForm=Object(r["a"])({},i),Object(m["g"])({list:a}).then((function(e){var a=e.data,i=[];t.successCount=a.successCount,t.unSuccessCount=a.unSuccessCount;var n=a.unSuccessList?a.unSuccessList:[];n.forEach((function(t){i.push(t)})),a.successCount>"0"&&t.searchClick(),"0"==a.unSuccessCount?t.$message.success("导入成功"):(t.errorTableDataList=i,t.errorDetailsDialogVisible=!0)})).finally((function(){t.uploading=!1}))},batchImportClick:function(){this.$refs["excel-upload-input"].click()},generateData:function(t){var e=t.header,a=t.results;this.excelData.header=e,this.excelData.results=a,this.handleSuccess()},handleClick:function(t){this.upload(this.$refs["excel-upload-input"].files[0])},beforeUpload:function(t){t.name;return!1},upload:function(t){this.readerData(t)},readerData:function(t){var e=this;this.uploading=!0;var a=new FileReader;a.onload=function(t){var a=t.target.result,i=c.a.read(a,{type:"array",dateNF:"yyyy-mm-dd"}),n=i.SheetNames[0],s=i.Sheets[n],r=e.getHeaderRow(s),o=e.getJsonData(s),l=o.filter((function(t){return!1===t.satify}));e.$refs["excel-upload-input"].value="",l.length>0?(e.errorTableDataList=l,e.errorDetailsDialogVisible=!0,e.uploading=!1,o=o.filter((function(t){return!0===t.satify})),e.generateData({header:r,results:o})):o.length>0?e.generateData({header:r,results:o}):(e.$message.warning("请选择有数据的excel"),e.uploading=!1)},a.readAsArrayBuffer(t)},getHeaderRow:function(t){var e,a=[],i=c.a.utils.decode_range(t["!ref"]),n=i.s.r;for(e=i.s.c;e<=i.e.c;++e){var s=t[c.a.utils.encode_cell({c:e,r:n})],r="UNKNOWN "+e;s&&s.t&&(r=c.a.utils.format_cell(s)),a.push(r)}return this.excelData.header=a,a},getJsonData:function(t){for(var e=this,a=[],i=["cardID","nativePlace","nation","health","workday","joinPartyDay","education","retirementTime","attorneys","attorneysPhone","abroadReason","destination","toAbroadTime","residenceTime","accompanier","lastTimeToAbroad","lastTimeToAbroadTime","credentials","zhAddress","enAddress","selfCare","resume","domesticRelatives","abroadRelatives","political","attach"],n=[0,1,2,3,4,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24],s=c.a.utils.decode_range(t["!ref"]),o={},l=function(l){for(var d={unSuccessInfo:"",satify:!0},m=function(a){var n=t[c.a.utils.encode_cell({c:a,r:l})];switch(d[i[a]]=c.a.utils.format_cell(n),i[a]){case"cardID":d[i[a]]=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|31)|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}([0-9]|x|X)$/.test(d[i[a]])?d[i[a]]:"",o[d[i[a]]]&&(d.unSuccessInfo="重复的公民身份号码"),o[d[i[a]]]=!0;break;case"workday":case"joinPartyDay":case"lastTimeToAbroadTime":d[i[a]]=/^\d{4}\/\d{2}\/\d{2}$/.test(d[i[a]])&&p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf()&&p()(d[i[a]],"YYYY-MM-DD").endOf("day").valueOf()<p()().endOf("day").valueOf()?p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf().toString():"";break;case"retirementTime":case"toAbroadTime":d[i[a]]=/^\d{4}\/\d{2}\/\d{2}$/.test(d[i[a]])&&p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf()&&p()(d[i[a]],"YYYY-MM-DD").endOf("day").valueOf()>p()().endOf("day").valueOf()?p()(d[i[a]],"YYYY-MM-DD").startOf("day").valueOf().toString():"";break;case"attorneysPhone":d[i[a]]=/^[1][3-9][0-9]{9}$/.test(d[i[a]])?d[i[a]]:"";break;case"residenceTime":d[i[a]]=Number(d[i[a]])?d[i[a]]:"";break;case"credentials":var s=e.plainOptions.find((function(t){return d[i[a]]===t.label}));d[i[a]]=s?s.value:"";break;case"nativePlace":case"nation":case"attorneys":case"accompanier":d[i[a]]=/^[\u4e00-\u9fa5]+$/.test(d[i[a]])?d[i[a]]:"";break;case"health":d[i[a]]="健康"===d[i[a]]||"不健康"===d[i[a]]?d[i[a]]:"";break;case"education":var r=e.educationList.find((function(t){return d[i[a]]===t.label}));d[i[a]]=r?r.value:"";break;case"enAddress":d[i[a]]=/^[\u4e00-\u9fa5]+$/.test(d[i[a]])?"":d[i[a]];default:break}},u=s.s.c;u<=s.e.c;++u)m(u);"330206195712028743"==d.cardID&&(d.unSuccessInfo="前往关注地区"),"330282197811141452"==d.cardID&&(d.unSuccessInfo="多次前往同一地区"),d.unSuccessInfo&&(d.unSuccessInfo+="，第".concat(l,"行以下列出现错误："),d.satify=!1);for(var h=0;h<n.length;h++){var f=n[h];if(!d[i[f]]){d.satify=!1,d.unSuccessInfo||(d.unSuccessInfo="第".concat(l,"行以下列的出现错误："));try{if(e.excelData.header[f]!==e.excelColumns[f].header)throw!1;d.unSuccessInfo+="".concat(e.excelColumns[f].header.replace("（必填）",""),"，")}catch(y){d.unSuccessInfo="请使用正确的模板";break}}}d.unSuccessInfo.lastIndexOf("：")===d.unSuccessInfo.length-1&&(d.unSuccessInfo=d.unSuccessInfo.replace("第".concat(l,"行以下列出现错误："),"")),d.unSuccessInfo.lastIndexOf("，")===d.unSuccessInfo.length-1&&(d.unSuccessInfo=d.unSuccessInfo.slice(0,d.unSuccessInfo.length-1));var v=Object(r["a"])({},d);delete v.unSuccessInfo,Object.values(v).every((function(t){return 0==t}))?d.satify=!1:a.push(d)},d=s.s.r+1;d<=s.e.r;++d)l(d);return a}},watch:{}},mt=pt,ut=(a("88b6"),a("3236"),Object(C["a"])(mt,i,n,!1,null,"7b89d993",null));e["default"]=ut.exports},3236:function(t,e,a){"use strict";var i=a("7a4d"),n=a.n(i);n.a},6572:function(t,e,a){},"7a4d":function(t,e,a){},"81b6":function(t,e,a){"use strict";var i=a("946f");e["a"]={ADD:{current:1,values:[i["a"]["ADD"].value,i["a"]["EDITED"].value],title:"数据录入"},PRINTED:{current:2,values:[i["a"]["PRINTED"].value],title:"数据审批"},SUBMITTED:{current:4,values:[i["a"]["SUBMITTED"].value,i["a"]["DISMISSED"].value,i["a"]["SUCCESSFUL_FILING"].value],title:"数据提交"}}},"88b6":function(t,e,a){"use strict";var i=a("6572"),n=a.n(i);n.a},"9a4e":function(t,e,a){},a383:function(t,e,a){"use strict";e["a"]={ADD:{value:"1",text:"新增",color:"gold"},EDITED:{value:"2",text:"已编辑",color:"gold"},PACKED:{value:"3",text:"已组包",color:"gold"},PRINTED:{value:"4",text:"已打印",color:"gold"},COLLECTED:{value:"5",text:"已采集",color:"gold"},SUBMITTED:{value:"6",text:"已提交",color:"gold"},DISMISSED:{value:"7",text:"被驳回",color:"red"},SUCCESSFUL_FILING:{value:"8",text:"上报成功",color:"green"}}},ecb3:function(t,e,a){"use strict";var i=a("9a4e"),n=a.n(i);n.a}}]);