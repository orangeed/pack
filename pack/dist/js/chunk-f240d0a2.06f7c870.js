(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f240d0a2"],{"522c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-header-wrapper"),a("a-card",{staticStyle:{position:"relative","margin-top":"24px"}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:1===t.stepsCur,expression:"stepsCur === 1"}],staticStyle:{position:"absolute",left:"30px",top:"25px"},attrs:{shape:"circle",type:"primary"},on:{click:function(e){return t.pre()}}},[a("a-icon",{attrs:{type:"arrow-left"}})],1),a("div",{staticStyle:{width:"600px","max-width":"800px"}},[a("a-steps",{attrs:{current:t.stepsCur}},[a("a-step",{attrs:{title:"选择入库证件信息"}}),a("a-step",{attrs:{title:"确认证件入库"}}),a("a-step",{attrs:{title:"完成"}})],1)],1),a("a-tabs",{attrs:{activeKey:t.activeKey,type:"card"},on:{change:t.tabsChange}},[a("a-tab-pane",{key:"1",attrs:{tab:"选择入库证件信息"}},[a("a-input-search",{staticStyle:{width:"300px","margin-top":"24px"},attrs:{placeholder:"输入姓名或证件号码进行搜索",allowClear:""},on:{blur:t.onSearch,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(e)}},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[a("a-icon",{staticStyle:{"margin-right":"5px"},attrs:{slot:"suffix",type:"scan"},on:{click:t.scan},slot:"suffix"})],1),a("a-spin",{attrs:{spinning:t.tableLoading}},[a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:t.pagination,rowKey:function(t){return t.id},"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},scopedSlots:t._u([{key:"cardID",fn:function(e,n){return a("span",{},[t._v(t._s(t._f("cardIDShade")(n.cardID)))])}},{key:"certificateType",fn:function(e,n){return a("span",{},[t._v(t._s(t._f("certificateTypeFilters")(e)))])}}])})],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"确认证件入库"}},[a("a-table",{attrs:{columns:t.colunmsSecond,dataSource:t.checkTableData,rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"cardID",fn:function(e,n){return a("span",{},[t._v(t._s(t._f("cardIDShade")(n.cardID)))])}},{key:"certificateType",fn:function(e,n){return a("span",{},[t._v(t._s(t._f("certificateTypeFilters")(e)))])}},{key:"status",fn:function(e,n){return a("span",{},[a("a-badge",{attrs:{color:t._f("stateColorFilter")(e),text:t._f("stateTextFilter")(e)}})],1)}},{key:"operate",fn:function(e,n){return a("span",{},[a("a",{on:{click:function(e){return t.showCheck(n)}}},[t._v("核验")])])}}])}),a("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"24px"}},[a("span",{staticStyle:{width:"70px"}},[t._v("备注：")]),a("a-input",{attrs:{placeholder:"请输入备注信息"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:"完成"}},[a("a-result",{attrs:{status:t.resultState,"sub-title":t.resultInfo,title:t.resultTitle},scopedSlots:t._u([{key:"extra",fn:function(){return[a("a-button",{key:"console",attrs:{type:"primary"},on:{click:function(e){return t.back()}}},[t._v("返回")])]},proxy:!0}])},[t.isAbnormal?a("div",{staticClass:"errInfo"},[a("p",{staticStyle:{"font-size":"16px"}},[a("strong",[t._v("以下人员证件入库失败:")])]),t._l(t.returnData.unsuccessList,(function(e){return a("div",{key:e.cardID,staticStyle:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"5px"}},[a("a-icon",{style:{color:"orange","margin-right":"10px"},attrs:{type:"exclamation-circle"}}),a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(e.name+" - ")+" "+t._s(t._f("certificateTypeFilters")(e.cardType)))]),a("a-popover",{attrs:{title:"入库失败原因",trigger:"click"}},[a("template",{slot:"content"},[a("p",[t._v("姓名："+t._s(e.name))]),a("p",[t._v("证件类型："+t._s(t._f("certificateTypeFilters")(e.cardType)))]),a("p",[t._v("证件号码："+t._s(e.cardID))]),a("p",[t._v("原因："+t._s(e.unsuccessInfo))])]),a("a-button",{attrs:{type:"primary",size:"small"}},[t._v("详情")])],2)],1)}))],2):t._e()])],1)],1),a("div",{staticStyle:{display:"flex"}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:2!==t.stepsCur,expression:"stepsCur !== 2"}],attrs:{type:"primary"},on:{click:function(e){return t.next()}}},[t._v("下一步")])],1),a("a-divider"),a("div",{staticStyle:{width:"100%"}},[a("p",{staticStyle:{"line-height":"23px","font-size":"20px",color:"#8d8d8d","font-weight":"bold"}},[t._v("说明")]),a("p",{staticClass:"title",staticStyle:{"font-size":"14px",color:"#8d8d8d","font-weight":"bold"}},[t._v(t._s(t.explainTtile))]),a("p",{staticStyle:{"font-size":"14px",color:"#8d8d8d"}},[t._v(t._s(t.explainDetails))])])],1),a("a-modal",{attrs:{visible:t.checkvisible,footer:null,title:"证件核验",width:"500px",destroyOnClose:"",centered:!0},on:{cancel:function(e){t.checkvisible=!1}}},[a("a-form-model",{attrs:{model:t.checkForm,"label-col":{span:4},"wrapper-col":{span:14}}},[a("a-form-model-item",{attrs:{label:"姓名"}},[a("a-input",{attrs:{disabled:""},model:{value:t.checkForm.name,callback:function(e){t.$set(t.checkForm,"name",e)},expression:"checkForm.name"}})],1),a("a-form-model-item",{attrs:{label:"英文名"}},[a("a-input",{model:{value:t.checkForm.enName,callback:function(e){t.$set(t.checkForm,"enName",e)},expression:"checkForm.enName"}})],1),a("a-form-model-item",{attrs:{label:"证件号码"}},[a("a-input",{model:{value:t.checkForm.certNum,callback:function(e){t.$set(t.checkForm,"certNum",e)},expression:"checkForm.certNum"}})],1),a("a-form-model-item",{attrs:{label:"证件类型"}},[a("a-input",{attrs:{disabled:""},model:{value:t.checkForm.virtual,callback:function(e){t.$set(t.checkForm,"virtual",e)},expression:"checkForm.virtual"}})],1),a("a-form-model-item",{attrs:{label:"有效期"}},[a("a-input",{model:{value:t.checkForm.expirationDate,callback:function(e){t.$set(t.checkForm,"expirationDate",e)},expression:"checkForm.expirationDate"}})],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[a("a-button",{attrs:{type:"primary"},on:{click:t.checkFormSubmit}},[t._v("核验")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){t.checkvisible=!1}}},[t._v("返回")])],1)],1)],1)],1)},r=[],i=(a("99af"),a("7db0"),a("4160"),a("b0c0"),a("d3b7"),a("25f0"),a("498a"),a("159b"),a("5530")),c=a("2909"),s=a("ca00"),o=a("c6ff"),l=a("b775"),u={getEnterCainetInfo:function(t){return Object(l["b"])({url:"/virtual/operations/inCabinet",method:"get",params:t})},addEnterCainetInfo:function(t){return Object(l["b"])({url:"/virtual/operations/inCabinet",method:"post",data:t})},getPersonInfo:function(t){return Object(l["b"])({url:"/person/info",method:"get",params:t})}},d=a("eb20"),p=(a("d9cd"),[{title:"持证人",key:"certificateHolder",width:100,dataIndex:"certificateHolder",align:"center"},{title:"公民身份号码",key:"cardID",width:200,dataIndex:"cardID",align:"center",scopedSlots:{customRender:"cardID"}},{title:"性别",dataIndex:"sex",key:"sex",width:70,align:"center"},{title:"证件类型",dataIndex:"certificateType",key:"certificateType",width:150,align:"center",scopedSlots:{customRender:"certificateType"}}]),f=[{title:"持证人",key:"certificateHolder",width:100,dataIndex:"certificateHolder",align:"center"},{title:"性别",dataIndex:"sex",key:"sex",width:70,align:"center"},{title:"公民身份号码",key:"cardID",width:200,dataIndex:"cardID",align:"center",scopedSlots:{customRender:"cardID"}},{title:"证件类型",dataIndex:"certificateType",key:"certificateType",width:150,align:"center",scopedSlots:{customRender:"certificateType"}},{title:"状态",dataIndex:"status",width:150,align:"center",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operate",width:150,align:"center",scopedSlots:{customRender:"operate"}}],h=[],m={name:"papersEnter",data:function(){var t=this;return{virtual:[{id:"1",text:"普通护照",value:"414"},{id:"2",text:"往来港澳通行证及签注",value:"513"},{id:"3",text:"往来台湾通行证及签注",value:"517"}],form:{},columns:p,colunmsSecond:f,dataSource:h,checkTableData:[],pagination:{pageNo:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showTotal:function(e){return"共 ".concat(e," 条记录 第").concat(t.pagination.pageNo,"/").concat(Math.ceil(e/t.pagination.pageSize),"页")},onChange:function(e,a){t.pagination.pageNo=e,t.getList()},onShowSizeChange:function(e,a){t.pagination.pageNo=e,t.pagination.pageSize=a,t.getList()}},stepsCur:0,selectedRowKeys:[],explain:[{title:"选择入库证件",details:"首先，用户在待入库证件列表中勾选需要入库的证件记录，点击“下一步”按钮，进入下一步骤。此外，用户可以从上方的搜索栏中输入持证人姓名、证件号码等条件进行查询 。"},{title:"证件入库确认",details:"用户需要确认证件入库的相关信息"},{title:"入库完成",details:"出现“入库完成”字样表示当前证件已经入库完成，若显示异常，则联系管理员！"}],remark:"",searchValue:"",resultState:"error",resultTitle:"入柜失败",resultInfo:"123",tableLoading:!1,isAbnormal:!1,returnData:{successCount:"12",unSuccessCount:"32",unsuccessList:[{name:"张三",cardType:"1",cardID:"E15153101",unsuccessInfo:"失败信息"},{name:"李四",cardType:"2",cardID:"E15153102",unsuccessInfo:"失败信息"},{name:"王五",cardType:"3",cardID:"E15153103",unsuccessInfo:"失败信息"}]},nowlength:0,temporaryData:[],checkvisible:!1,checkForm:{}}},created:function(){this.getList()},methods:{tabsChange:function(){},onSelectChange:function(t,e){var a=this;this.selectedRowKeys=t;for(var n=[],r=function(r){var i=t[r],c=a.checkTableData.find((function(t){return t.id==i})),s=c||e.find((function(t){return t.id==i}));n.push(s)},i=0;i<t.length;i++)r(i);this.checkTableData=n},scan:function(){},onSearch:function(){var t=this;setTimeout((function(){t.getList()}),100)},pre:function(){this.stepsCur--},next:function(){var t=this;if(0===this.stepsCur){if(this.selectedRowKeys.length<=0)return this.$message.error("请至少选中一项数据！");this.temporaryData=Object(c["a"])(this.checkTableData),this.stepsCur++}else if(1===this.stepsCur){for(var e=[],a=0;a<this.checkTableData.length;a++){var n=this.checkTableData[a];if("已核验"!==n.status)return void this.$message.error("请先完成所有核验!")}if(0===this.checkTableData.length)return this.$message.error("请选择证件!");if(this.checkTableData.forEach((function(t){var a={};a=Object(i["a"])({},t),a.enName="new",e.push(a)})),""===this.remark.trim())return this.$message.error("请输入备注信息!");u.addEnterCainetInfo({list:e,remark:this.remark}).then((function(e){0!==e.errorCode?(t.resultState="error",t.resultTitle="入库失败",t.resultInfo="入库失败",t.$message.error("服务器错误，入库失败!")):(t.returnData=e.data,"0"===t.returnData.unSuccessCount.toString()?(t.resultState="success",t.resultTitle="入库完成",t.resultInfo="入库成功"):(t.isAbnormal=!0,t.resultState="warning",t.resultTitle="入库异常",t.resultInfo="入库总数".concat(t.temporaryData.length,"个，成功").concat(t.returnData.successCount,"个，失败").concat(t.returnData.unSuccessCount,"个")),d["a"]({key:"证件催缴",id:"证件催缴"})),t.stepsCur++,t.pagination.pageNo=1}))}},back:function(){this.selectedRowKeys=[],this.checkTableData=[],this.checkForm={},this.from={},this.stepsCur=0,this.remark="",this.getList()},getList:function(){var t=this;this.tableLoading=!0,this.selectedRowKeys=[],u.getEnterCainetInfo({selectValue:this.searchValue,pageNo:this.pagination.pageNo,pageSize:this.pagination.pageSize,direction:"1"}).then((function(e){if("0"===e.data.total||null===e.data.data)return t.dataSource=[];t.pagination.total=parseInt(e.data.total),t.dataSource=e.data.data})).finally((function(){t.tableLoading=!1}))},showCheck:function(t){var e=this;this.checkvisible=!0,this.checkForm=t,this.checkForm.name=t.certificateHolder,this.virtual.forEach((function(a){a.id==t.certificateType&&(e.checkForm.virtual=a.text,e.checkForm.certType=a.value)}))},checkFormSubmit:function(){var t=this,e={cardID:this.checkForm.cardID,certificateType:this.checkForm.certificateType},a=this.$message.loading("正在核验中",0);setTimeout(a,2500),setTimeout((function(){u.getPersonInfo(e).then((function(e){0===e.errorCode&&(t.checkForm.certNum=e.data.credentialsID,t.checkForm.enName="new",t.$message.success("核验成功"),t.form=t.checkForm,t.checkTableData.forEach((function(e){e.id==t.checkForm.id&&(e.status="已核验")})),t.checkTableData=Object(c["a"])(t.checkTableData))}))}),2500)}},computed:{activeKey:function(){var t=this.stepsCur+1;return t.toString()},explainTtile:function(){return this.explain[this.stepsCur].title},explainDetails:function(){return this.explain[this.stepsCur].details}},filters:{certificateTypeFilters:function(t){return Object(o["d"])(t)},stateColorFilter:function(t){return"已核验"==t?"green":"red"},stateTextFilter:function(t){return t?"已核验":"待核验"},cardIDShade:s["a"]}},k=m,g=(a("dd1a"),a("2877")),y=Object(g["a"])(k,n,r,!1,null,"a441db7c",null);e["default"]=y.exports},c6ff:function(t,e,a){"use strict";function n(t){var e={1:"电子护照",2:"港澳通行证",3:"台湾通行证"};return e[t]}function r(t){switch(t){case"电子护照":return"1";case"港澳通行证":return"2";case"台湾通行证":return"3";default:return"0"}}function i(t){var e={0:"离柜",1:"在柜",2:"待取出",3:"待入库"};return e[t]}function c(t){var e={0:"red",1:"green",2:"blue",3:"orange"};return e[t]}a.d(e,"d",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return c}))},dd1a:function(t,e,a){"use strict";var n=a("de9f"),r=a.n(n);r.a},de9f:function(t,e,a){}}]);